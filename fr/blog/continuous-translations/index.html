<!DOCTYPE html><html lang="fr" dir="ltr" data-theme="dark" data-has-toc data-has-sidebar class="astro-xqcezzus"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Traductions Markdown Continues | GenAIScript</title><link rel="canonical" href="https://microsoft.github.io/genaiscript/fr/blog/continuous-translations/"/><link rel="alternate" hreflang="en" href="https://microsoft.github.io/genaiscript/blog/continuous-translations/"/><link rel="alternate" hreflang="fr" href="https://microsoft.github.io/genaiscript/fr/blog/continuous-translations/"/><link rel="sitemap" href="/genaiscript/sitemap-index.xml"/><link href="https://microsoft.github.io/genaiscript/blog/rss.xml" rel="alternate" title="Blog" type="application/rss+xml"/><link rel="shortcut icon" href="/genaiscript/images/favicon.png" type="image/png"/><meta name="generator" content="Astro v5.11.0"/><meta name="generator" content="Starlight v0.34.4"/><meta property="og:title" content="Traductions Markdown Continues"/><meta property="og:type" content="article"/><meta property="og:url" content="https://microsoft.github.io/genaiscript/fr/blog/continuous-translations/"/><meta property="og:locale" content="fr"/><meta property="og:description" content="Un aperçu du script qui traduit la documentation GenAIScript dans plusieurs langues."/><meta property="og:site_name" content="GenAIScript"/><meta name="twitter:card" content="summary_large_image"/><meta name="description" content="Un aperçu du script qui traduit la documentation GenAIScript dans plusieurs langues."/> <link href="https://microsoft.github.io/genaiscript/llms.txt" rel="llms-txt" type="text/markdown"> <link href="https://microsoft.github.io/genaiscript/fr/blog/continuous-translations.md" rel="alternate" type="text/markdown"> <script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg><svg aria-hidden="true" class="dark astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg><svg aria-hidden="true" class="auto astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg></template><link rel="stylesheet" href="/genaiscript/_astro/print.DNXP8c50.css" media="print"><link rel="stylesheet" href="/genaiscript/_astro/Authors.CcSrn0tq.css">
<style>@layer starlight.components{:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-jkdjoadd){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-jkdjoadd){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-jkdjoadd){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-jkdjoadd){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-jkdjoadd){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-jkdjoadd){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-jkdjoadd){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-jkdjoadd){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-jkdjoadd){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-jkdjoadd){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-jkdjoadd){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-jkdjoadd){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-jkdjoadd){vertical-align:middle}}
@layer starlight.components{.card-grid:where(.astro-ymfibcsc){display:grid;grid-template-columns:100%;gap:1rem}.card-grid:where(.astro-ymfibcsc)>*{margin-top:0!important}@media (min-width: 50rem){.card-grid:where(.astro-ymfibcsc){grid-template-columns:1fr 1fr;gap:1.5rem}.stagger:where(.astro-ymfibcsc){--stagger-height: 5rem;padding-bottom:var(--stagger-height)}.stagger:where(.astro-ymfibcsc)>*:nth-child(2n){transform:translateY(var(--stagger-height))}}}
@layer starlight.components{.card:where(.astro-fe7tce6e){--sl-card-border: var(--sl-color-purple);--sl-card-bg: var(--sl-color-purple-low);border:1px solid var(--sl-color-gray-5);background-color:var(--sl-color-black);padding:clamp(1rem,calc(.125rem + 3vw),2.5rem);flex-direction:column;gap:clamp(.5rem,calc(.125rem + 1vw),1rem)}.card:where(.astro-fe7tce6e):nth-child(4n+1){--sl-card-border: var(--sl-color-orange);--sl-card-bg: var(--sl-color-orange-low)}.card:where(.astro-fe7tce6e):nth-child(4n+3){--sl-card-border: var(--sl-color-green);--sl-card-bg: var(--sl-color-green-low)}.card:where(.astro-fe7tce6e):nth-child(4n+4){--sl-card-border: var(--sl-color-red);--sl-card-bg: var(--sl-color-red-low)}.card:where(.astro-fe7tce6e):nth-child(4n+5){--sl-card-border: var(--sl-color-blue);--sl-card-bg: var(--sl-color-blue-low)}.title:where(.astro-fe7tce6e){font-weight:600;font-size:var(--sl-text-h4);color:var(--sl-color-white);line-height:var(--sl-line-height-headings);gap:1rem;align-items:center}.card:where(.astro-fe7tce6e) .icon:where(.astro-fe7tce6e){border:1px solid var(--sl-card-border);background-color:var(--sl-card-bg);padding:.2em;border-radius:.25rem;flex-shrink:0}.card:where(.astro-fe7tce6e) .body:where(.astro-fe7tce6e){margin:0;font-size:clamp(var(--sl-text-sm),calc(.5rem + 1vw),var(--sl-text-body))}}
@layer starlight.components{svg:where(.astro-bq6csbgl){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}}
@layer starlight.components{starlight-tabs:where(.astro-jw7ocou4){display:block}.tablist-wrapper:where(.astro-jw7ocou4){overflow-x:auto}:where(.astro-jw7ocou4)[role=tablist]{display:flex;list-style:none;border-bottom:2px solid var(--sl-color-gray-5);padding:0}.tab:where(.astro-jw7ocou4){margin-bottom:-2px}.tab:where(.astro-jw7ocou4)>:where(.astro-jw7ocou4)[role=tab]{display:flex;align-items:center;gap:.5rem;padding:0 1.25rem;text-decoration:none;border-bottom:2px solid var(--sl-color-gray-5);color:var(--sl-color-gray-3);outline-offset:var(--sl-outline-offset-inside);overflow-wrap:initial}.tab:where(.astro-jw7ocou4) :where(.astro-jw7ocou4)[role=tab][aria-selected=true]{color:var(--sl-color-white);border-color:var(--sl-color-text-accent);font-weight:600}.tablist-wrapper:where(.astro-jw7ocou4)~[role=tabpanel]{margin-top:1rem}}
@layer starlight.components{.sl-link-card:where(.astro-7m3pweiq){display:grid;grid-template-columns:1fr auto;gap:.5rem;border:1px solid var(--sl-color-gray-5);border-radius:.5rem;padding:1rem;box-shadow:var(--sl-shadow-sm);position:relative}a:where(.astro-7m3pweiq){text-decoration:none;line-height:var(--sl-line-height-headings)}a:where(.astro-7m3pweiq):before{content:"";position:absolute;inset:0}.stack:where(.astro-7m3pweiq){flex-direction:column;gap:.5rem}.title:where(.astro-7m3pweiq){color:var(--sl-color-white);font-weight:600;font-size:var(--sl-text-lg)}.description:where(.astro-7m3pweiq){color:var(--sl-color-gray-3);line-height:1.5}.icon:where(.astro-7m3pweiq){color:var(--sl-color-gray-3)}.sl-link-card:where(.astro-7m3pweiq):hover{background:var(--sl-color-gray-7, var(--sl-color-gray-6));border-color:var(--sl-color-gray-2)}.sl-link-card:where(.astro-7m3pweiq):hover .icon:where(.astro-7m3pweiq){color:var(--sl-color-white)}}
@layer starlight.components{.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}}@layer starlight.content{.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}}
@layer starlight.components{starlight-file-tree:where(.astro-doil54im){--x-space: 1.5rem;--y-space: .125rem;--y-pad: 0;display:block;border:1px solid var(--sl-color-gray-5);padding:1rem;background-color:var(--sl-color-gray-6);font-size:var(--sl-text-xs);font-family:var(--__sl-font-mono);overflow-x:auto}starlight-file-tree:where(.astro-doil54im) .directory>details{border:0;padding:0;padding-inline-start:var(--x-space);background:transparent}starlight-file-tree:where(.astro-doil54im) .directory>details>summary{margin-inline-start:calc(-1 * var(--x-space));border:0;padding:var(--y-pad) .625rem;font-weight:400;color:var(--sl-color-white);max-width:100%}starlight-file-tree:where(.astro-doil54im) .directory>details>summary::marker,starlight-file-tree:where(.astro-doil54im) .directory>details>summary::-webkit-details-marker{color:var(--sl-color-gray-3)}starlight-file-tree:where(.astro-doil54im) .directory>details>summary:hover,starlight-file-tree:where(.astro-doil54im) .directory>details>summary:hover .tree-icon{cursor:pointer;color:var(--sl-color-text-accent);fill:currentColor}starlight-file-tree:where(.astro-doil54im) .directory>details>summary:hover~ul{border-color:var(--sl-color-gray-4)}starlight-file-tree:where(.astro-doil54im) .directory>details>summary:hover .highlight .tree-icon{color:var(--sl-color-text-invert);fill:currentColor}starlight-file-tree:where(.astro-doil54im) ul{margin-inline-start:.5rem;border-inline-start:1px solid var(--sl-color-gray-5);padding:0;padding-inline-start:.125rem;list-style:none}starlight-file-tree:where(.astro-doil54im)>ul{margin:0;border:0;padding:0}starlight-file-tree:where(.astro-doil54im) li{margin:var(--y-space) 0;padding:var(--y-pad) 0}starlight-file-tree:where(.astro-doil54im) .file{margin-inline-start:calc(var(--x-space) - .125rem);color:var(--sl-color-white)}starlight-file-tree:where(.astro-doil54im) .tree-entry{display:inline-flex;align-items:flex-start;flex-wrap:wrap;max-width:calc(100% - 1rem)}@media (min-width: 30em){starlight-file-tree:where(.astro-doil54im) .tree-entry{flex-wrap:nowrap}}starlight-file-tree:where(.astro-doil54im) .tree-entry>:first-child{flex-shrink:0}starlight-file-tree:where(.astro-doil54im) .empty{color:var(--sl-color-gray-3);padding-inline-start:.375rem}starlight-file-tree:where(.astro-doil54im) .comment{color:var(--sl-color-gray-3);padding-inline-start:1.625rem;max-width:24rem;min-width:12rem}starlight-file-tree:where(.astro-doil54im) .highlight{display:inline-block;border-radius:.25rem;padding-inline-end:.5rem;color:var(--sl-color-text-invert);background-color:var(--sl-color-text-accent)}starlight-file-tree:where(.astro-doil54im) svg{display:inline;fill:var(--sl-color-gray-3);vertical-align:middle;margin-inline:.25rem .375rem;width:.875rem;height:.875rem}starlight-file-tree:where(.astro-doil54im) .highlight svg.tree-icon{fill:currentColor}}
@layer starlight.components{.sl-link-button:where(.astro-rnzosx4f){align-items:center;border:1px solid transparent;border-radius:999rem;display:inline-flex;font-size:var(--sl-text-sm);gap:.5em;line-height:1.1875;outline-offset:.25rem;padding:.4375rem 1.125rem;text-decoration:none}.sl-link-button:where(.astro-rnzosx4f).primary{background:var(--sl-color-text-accent);border-color:var(--sl-color-text-accent);color:var(--sl-color-black)}.sl-link-button:where(.astro-rnzosx4f).primary:hover{color:var(--sl-color-black)}.sl-link-button:where(.astro-rnzosx4f).secondary{border-color:inherit;color:var(--sl-color-white)}.sl-link-button:where(.astro-rnzosx4f).minimal{color:var(--sl-color-white);padding-inline:0}.sl-link-button:where(.astro-rnzosx4f) svg{flex-shrink:0}@media (min-width: 50rem){.sl-link-button:where(.astro-rnzosx4f){font-size:var(--sl-text-base);padding:.9375rem 1.25rem}}.sl-markdown-content .sl-link-button:where(.astro-rnzosx4f){margin-inline-end:1rem}.sl-markdown-content .sl-link-button:where(.astro-rnzosx4f):not(:where(p *)){margin-block:1rem}}
</style><script type="module" src="/genaiscript/_astro/page.7qqag-5g.js"></script></head> <body class="astro-xqcezzus"> <a href="#_top" class="astro-7uuznfpb">Aller au contenu</a>  <div class="page sl-flex astro-w64kkxlm"> <header class="header astro-w64kkxlm"><div class="header astro-ibjlrj3y"> <div class="title-wrapper sl-flex astro-ibjlrj3y"> <a href="/genaiscript/fr" class="site-title sl-flex astro-jvevelow">  <img class="astro-jvevelow" alt src="/genaiscript/_astro/logo.C7y7Xksc.svg" width="630" height="630">  <span class="astro-jvevelow" translate="no"> GenAIScript </span> </a>  </div> <div class="sl-flex print:hidden astro-ibjlrj3y"> <site-search class="astro-ibjlrj3y astro-c6yrggpy" data-translations="{&#34;placeholder&#34;:&#34;Rechercher&#34;}"> <button data-open-modal disabled aria-label="Rechercher" aria-keyshortcuts="Control+K" class="astro-c6yrggpy"> <svg aria-hidden="true" class="astro-c6yrggpy astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg> <span class="sl-hidden md:sl-block astro-c6yrggpy" aria-hidden="true">Rechercher</span> <kbd class="sl-hidden md:sl-flex astro-c6yrggpy" style="display: none;"> <kbd class="astro-c6yrggpy">Ctrl</kbd><kbd class="astro-c6yrggpy">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="Rechercher" class="astro-c6yrggpy"> <div class="dialog-frame sl-flex astro-c6yrggpy">  <button data-close-modal class="sl-flex md:sl-hidden astro-c6yrggpy"> Annuler </button> <div class="search-container astro-c6yrggpy"> <div id="starlight__search" class="astro-c6yrggpy"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = '⌘';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script> <script type="module" src="/genaiscript/_astro/Search.astro_astro_type_script_index_0_lang.ZFrA6PJ9.js"></script>   </div> <div class="sl-hidden md:sl-flex print:hidden right-group astro-ibjlrj3y"> <div class="sl-flex social-icons astro-ibjlrj3y"> <a href="https://discord.gg/y7HpumjHeB" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">Discord</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M20.32 4.37a19.8 19.8 0 0 0-4.93-1.51 13.78 13.78 0 0 0-.64 1.28 18.27 18.27 0 0 0-5.5 0 12.64 12.64 0 0 0-.64-1.28h-.05A19.74 19.74 0 0 0 3.64 4.4 20.26 20.26 0 0 0 .11 18.09l.02.02a19.9 19.9 0 0 0 6.04 3.03l.04-.02a14.24 14.24 0 0 0 1.23-2.03.08.08 0 0 0-.05-.07 13.1 13.1 0 0 1-1.9-.92.08.08 0 0 1 .02-.1 10.2 10.2 0 0 0 .41-.31h.04a14.2 14.2 0 0 0 12.1 0l.04.01a9.63 9.63 0 0 0 .4.32.08.08 0 0 1-.03.1 12.29 12.29 0 0 1-1.9.91.08.08 0 0 0-.02.1 15.97 15.97 0 0 0 1.27 2.01h.04a19.84 19.84 0 0 0 6.03-3.05v-.03a20.12 20.12 0 0 0-3.57-13.69ZM8.02 15.33c-1.18 0-2.16-1.08-2.16-2.42 0-1.33.96-2.42 2.16-2.42 1.21 0 2.18 1.1 2.16 2.42 0 1.34-.96 2.42-2.16 2.42Zm7.97 0c-1.18 0-2.15-1.08-2.15-2.42 0-1.33.95-2.42 2.15-2.42 1.22 0 2.18 1.1 2.16 2.42 0 1.34-.94 2.42-2.16 2.42Z"/></svg></a><a href="https://github.com/microsoft/genaiscript" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">GitHub</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a><a href="https://www.youtube.com/@pelihalleux" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">YouTube</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M23.5 6.2A3 3 0 0 0 21.4 4c-1.9-.5-9.4-.5-9.4-.5s-7.5 0-9.4.5A3 3 0 0 0 .5 6.3C0 8 0 12 0 12s0 4 .5 5.8A3 3 0 0 0 2.6 20c1.9.6 9.4.6 9.4.6s7.5 0 9.4-.6a3 3 0 0 0 2.1-2c.5-2 .5-5.9.5-5.9s0-4-.5-5.8zm-14 9.4V8.4l6.3 3.6-6.3 3.6z"/></svg></a><a href="https://microsoft.github.io/genaiscript/blog/rss.xml" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">RSS</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M2.88 16.88a3 3 0 0 0 0 4.24 3 3 0 0 0 4.24 0 3 3 0 0 0-4.24-4.24Zm2.83 2.83a1 1 0 0 1-1.42-1.42 1 1 0 0 1 1.42 0 1 1 0 0 1 0 1.42ZM5 12a1 1 0 0 0 0 2 5 5 0 0 1 5 5 1 1 0 0 0 2 0 7 7 0 0 0-7-7Zm0-4a1 1 0 0 0 0 2 9 9 0 0 1 9 9 1 1 0 0 0 2 0 11.08 11.08 0 0 0-3.22-7.78A11.08 11.08 0 0 0 5 8Zm10.61.39A15.11 15.11 0 0 0 5 4a1 1 0 0 0 0 2 13 13 0 0 1 13 13 1 1 0 0 0 2 0 15.11 15.11 0 0 0-4.39-10.61Z"/></svg></a> </div> <div class="astro-7ggugoi7"> <a href="/genaiscript/fr/blog/" class="astro-7ggugoi7">Blog</a> </div>  <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-bs72fung"> <span class="sr-only astro-bs72fung">Selectionner le thème</span> <svg aria-hidden="true" class="icon label-icon astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select value="auto" autocomplete="off" class="astro-bs72fung"> <option value="dark" class="astro-bs72fung">Sombre</option><option value="light" class="astro-bs72fung">Clair</option><option value="auto" selected class="astro-bs72fung">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script> <script type="module">const r="starlight-theme",o=e=>e==="auto"||e==="dark"||e==="light"?e:"auto",c=()=>o(typeof localStorage<"u"&&localStorage.getItem(r));function n(e){typeof localStorage<"u"&&localStorage.setItem(r,e==="light"||e==="dark"?e:"")}const l=()=>matchMedia("(prefers-color-scheme: light)").matches?"light":"dark";function t(e){StarlightThemeProvider.updatePickers(e),document.documentElement.dataset.theme=e==="auto"?l():e,n(e)}matchMedia("(prefers-color-scheme: light)").addEventListener("change",()=>{c()==="auto"&&t("auto")});class s extends HTMLElement{constructor(){super(),t(c()),this.querySelector("select")?.addEventListener("change",a=>{a.currentTarget instanceof HTMLSelectElement&&t(o(a.currentTarget.value))})}}customElements.define("starlight-theme-select",s);</script> <starlight-lang-select><label style="--sl-select-width: 7em" class="astro-bs72fung"> <span class="sr-only astro-bs72fung">Selectionner la langue</span> <svg aria-hidden="true" class="icon label-icon astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path fill-rule="evenodd" d="M8.516 3a.94.94 0 0 0-.941.94v1.15H2.94a.94.94 0 1 0 0 1.882h7.362a7.422 7.422 0 0 1-1.787 3.958 7.42 7.42 0 0 1-1.422-2.425.94.94 0 1 0-1.774.627 9.303 9.303 0 0 0 1.785 3.043 7.422 7.422 0 0 1-4.164 1.278.94.94 0 1 0 0 1.881 9.303 9.303 0 0 0 5.575-1.855 9.303 9.303 0 0 0 4.11 1.74l-.763 1.525a.968.968 0 0 0-.016.034l-1.385 2.77a.94.94 0 1 0 1.683.841l1.133-2.267h5.806l1.134 2.267a.94.94 0 0 0 1.683-.841l-1.385-2.769a.95.95 0 0 0-.018-.036l-3.476-6.951a.94.94 0 0 0-1.682 0l-1.82 3.639a7.423 7.423 0 0 1-3.593-1.256 9.303 9.303 0 0 0 2.27-5.203h1.894a.94.94 0 0 0 0-1.881H9.456V3.94A.94.94 0 0 0 8.516 3Zm6.426 11.794a1.068 1.068 0 0 1-.02.039l-.703 1.407h3.924l-1.962-3.924-1.24 2.478Z" clip-rule="evenodd"/></svg> <select value="/genaiscript/fr/blog/continuous-translations/" autocomplete="off" class="astro-bs72fung"> <option value="/genaiscript/blog/continuous-translations/" class="astro-bs72fung">English</option><option value="/genaiscript/fr/blog/continuous-translations/" selected class="astro-bs72fung">French</option> </select> <svg aria-hidden="true" class="icon caret astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label> </starlight-lang-select><script type="module">class s extends HTMLElement{constructor(){super();const e=this.querySelector("select");e&&(e.addEventListener("change",t=>{t.currentTarget instanceof HTMLSelectElement&&(window.location.pathname=t.currentTarget.value)}),window.addEventListener("pageshow",t=>{if(!t.persisted)return;const n=e.querySelector("option[selected]")?.index;n!==e.selectedIndex&&(e.selectedIndex=n??0)}))}}customElements.define("starlight-lang-select",s);</script> </div> </div> </header> <nav class="sidebar print:hidden astro-w64kkxlm" aria-label="principale"> <starlight-menu-button class="print:hidden astro-3wm6tn25"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-3wm6tn25"> <svg aria-hidden="true" class="open-menu astro-3wm6tn25 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg> <svg aria-hidden="true" class="close-menu astro-3wm6tn25 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="m13.41 12 6.3-6.29a1.004 1.004 0 1 0-1.42-1.42L12 10.59l-6.29-6.3a1.004 1.004 0 0 0-1.42 1.42l6.3 6.29-6.3 6.29a1 1 0 0 0 0 1.42.998.998 0 0 0 1.42 0l6.29-6.3 6.29 6.3a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.42L13.41 12Z"/></svg> </button> </starlight-menu-button> <script type="module">class s extends HTMLElement{constructor(){super(),this.btn=this.querySelector("button"),this.btn.addEventListener("click",()=>this.toggleExpanded());const t=this.closest("nav");t&&t.addEventListener("keyup",e=>this.closeOnEscape(e))}setExpanded(t){this.setAttribute("aria-expanded",String(t)),document.body.toggleAttribute("data-mobile-menu-expanded",t)}toggleExpanded(){this.setExpanded(this.getAttribute("aria-expanded")!=="true")}closeOnEscape(t){t.code==="Escape"&&(this.setExpanded(!1),this.btn.focus())}}customElements.define("starlight-menu-button",s);</script>   <div id="starlight__sidebar" class="sidebar-pane astro-w64kkxlm"> <div class="sidebar-content sl-flex astro-w64kkxlm"> <sl-sidebar-state-persist data-hash="1hv8h9m" class="astro-3d5allzr"> <script aria-hidden="true">
		(() => {
			try {
				if (!matchMedia('(min-width: 50em)').matches) return;
				/** @type {HTMLElement | null} */
				const target = document.querySelector('sl-sidebar-state-persist');
				const state = JSON.parse(sessionStorage.getItem('sl-sidebar-state') || '0');
				if (!target || !state || target.dataset.hash !== state.hash) return;
				window._starlightScrollRestore = state.scroll;
				customElements.define(
					'sl-sidebar-restore',
					class SidebarRestore extends HTMLElement {
						connectedCallback() {
							try {
								const idx = parseInt(this.dataset.index || '');
								const details = this.closest('details');
								if (details && typeof state.open[idx] === 'boolean') details.open = state.open[idx];
							} catch {}
						}
					}
				);
			} catch {}
		})();
	</script>  <ul class="top-level astro-jvjwaqcl"> <li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/" aria-current="false" class="large astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Tous les articles</span>  </a> </li><li class="astro-jvjwaqcl"> <details open class="astro-jvjwaqcl"> <sl-sidebar-restore data-index="0"></sl-sidebar-restore> <summary class="astro-jvjwaqcl"> <div class="group-label astro-jvjwaqcl"> <span class="large astro-jvjwaqcl">Articles récents</span>  </div> <svg aria-hidden="true" class="caret astro-jvjwaqcl astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <ul class="astro-jvjwaqcl"> <li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/continuous-translations/" aria-current="page" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Traductions Markdown Continues</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/v2/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">2.0 - Une bibliothèque Node.JS</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/cline/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Écrire des workflows GenAIScript plus rapidement avec des assistants de codage</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/continuous-ai/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Intelligence Artificielle Continue</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/mermaids/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Sirènes sans faille</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/zine-prs/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Zine rencontre les Pull Requests (et plus)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/gpt-image-1/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GPT-Image-1</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/discord/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Server Discord</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/github-models-in-github-actions/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Modèles GitHub dans GitHub Actions</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/blog-narration/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Blog Narration</span>  </a> </li> </ul>  </details> </li><li class="astro-jvjwaqcl"> <details open class="astro-jvjwaqcl"> <sl-sidebar-restore data-index="1"></sl-sidebar-restore> <summary class="astro-jvjwaqcl"> <div class="group-label astro-jvjwaqcl"> <span class="large astro-jvjwaqcl">Étiquettes</span>  </div> <svg aria-hidden="true" class="caret astro-jvjwaqcl astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <ul class="astro-jvjwaqcl"> <li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/automation/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">automation (7)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/genaiscript/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GenAIScript (4)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/ai/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">ai (3)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/genai/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">genai (3)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/javascript/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">JavaScript (3)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/blog/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">blog (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/cicd/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">CI/CD (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/continuous-ai/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Continuous AI (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/dev/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">dev (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/documentation/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Documentation (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/llm/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">LLM (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/mcp/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">mcp (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/open-source/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Open Source (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/productivity/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Productivity (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/scripting/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">scripting (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/search/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">search (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/tools/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">tools (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/video/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Video (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/web/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">web (2)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/1-intent-validation/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">1. Intent Validation (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/2-llm-as-a-judge/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">2. LLM as a Judge (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/3-mcp-tool-risks/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">3. MCP Tool Risks (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/4-tool-description-hashing/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">4. Tool Description Hashing (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/5-tool-misbehavior-detection/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">5. Tool Misbehavior Detection (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/agent/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">agent (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/agent-abstraction-for-mcp/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Agent abstraction for MCP (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/ai-scripting-language/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">AI scripting language (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/anthropic/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">anthropic (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/api/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">api (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/architecture/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">architecture (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/ast/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">ast (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/ast-grep/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">ast-grep (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/azure/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">azure (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/azure-ai-foundry/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">azure ai foundry (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/browser-automation-tools/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Browser automation tools (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/class-diagrams/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Class diagrams (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/cline/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">cline (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/code-improvement/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">code improvement (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/coding-assistants/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">coding-assistants (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/content-analysis/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">content analysis (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/dall-e-comparison/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">dall-e comparison (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/deepseek/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">deepseek (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/development/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Development (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/discord/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">discord (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/dotjs-2025-talk/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">dotJS 2025 talk (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/ecosystem/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Ecosystem (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/engagement/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Engagement (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/ffmpeg/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">ffmpeg (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/genaiscript-framework/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GenAIScript framework (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/gists/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">gists (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/github-actions/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GitHub Actions (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/github-copilot/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GitHub Copilot (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/github-copilot-chat/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GitHub Copilot Chat (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/github-next/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GitHub Next (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/gpt-image-1/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">gpt-image-1 (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/hugging-face/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Hugging Face (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/image-generation/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">image generation (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/image-generators/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">image generators (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/images/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">images (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/integration/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Integration (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/interactive/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">interactive (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/maintenance/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Maintenance (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/markdown/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">markdown (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/markdown-diagrams/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Markdown diagrams (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/mcp-resources/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">MCP resources (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/mcp-server-configuration/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">MCP server configuration (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/mcp-tools/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">MCP tools (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/mermaid-diagrams/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Mermaid diagrams (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/mermaid-syntax-errors/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Mermaid syntax errors (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/microsoft-developer-advocate/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Microsoft Developer Advocate (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/model-context-protocol/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Model Context Protocol (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/models/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Models (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/narration/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">narration (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/o1/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">o1 (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/openai/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">openai (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/openai-gpt-image-1/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">openai gpt-image-1 (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/parallel-mcp-servers/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Parallel MCP servers (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/performance/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">performance (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/pixel-art-cat/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">pixel art cat (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/playwright/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">playwright (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/playwright-mcp-server/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Playwright MCP server (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/podcast/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">podcast (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/prompt-engineering/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Prompt Engineering (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/publishresource-method/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">publishResource method (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/pull-request-visualization/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">pull request visualization (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/questions/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">questions (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/rag/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">rag (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/react/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">react (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/readme/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">README (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/release/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">release (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/release-notes/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">release notes (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/scripts/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">scripts (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/sdk/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">sdk (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/seo-for-diagrams/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">SEO for diagrams (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/sketchnotes/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">sketchnotes (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/slm/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">SLM (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/software-annotation/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">software annotation (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/software-development/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">software development (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/summary/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">summary (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/tips-and-tricks/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Tips and Tricks (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/tool-integration/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Tool Integration (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/transform/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">transform (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/transformers/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">transformers (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/translations/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Translations (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/tree-sitter/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">tree-sitter (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/tutorials/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Tutorials (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/typescript/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">typescript (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/user-input/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">user-input (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/validation/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">validation (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/voice/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">voice (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/vscode/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">vscode (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/webview/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">webview (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/workflows/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Workflows (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/yohan-lasorsa/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Yohan Lasorsa (1)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/tags/zines/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">zines (1)</span>  </a> </li> </ul>  </details> </li><li class="astro-jvjwaqcl"> <details open class="astro-jvjwaqcl"> <sl-sidebar-restore data-index="2"></sl-sidebar-restore> <summary class="astro-jvjwaqcl"> <div class="group-label astro-jvjwaqcl"> <span class="large astro-jvjwaqcl">Auteurs</span>  </div> <svg aria-hidden="true" class="caret astro-jvjwaqcl astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <ul class="astro-jvjwaqcl"> <li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/authors/peli/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Peli (34)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/authors/genaiscript/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">GenAIScript (16)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/authors/matt-podwysocki/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Matt Podwysocki (7)</span>  </a> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/authors/volkan-unsal/" aria-current="false" class="astro-jvjwaqcl"> <span class="astro-jvjwaqcl">Volkan Unsal (7)</span>  </a> </li> </ul>  </details> </li><li class="astro-jvjwaqcl"> <a href="/genaiscript/fr/blog/rss.xml" aria-current="false" class="large astro-jvjwaqcl"> <span class="astro-jvjwaqcl">RSS</span>  </a> </li> </ul>   <script aria-hidden="true">
		(() => {
			const scroller = document.getElementById('starlight__sidebar');
			if (!window._starlightScrollRestore || !scroller) return;
			scroller.scrollTop = window._starlightScrollRestore;
			delete window._starlightScrollRestore;
		})();
	</script> </sl-sidebar-state-persist>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-m54kfj2q"> <div class="social-icons astro-m54kfj2q"> <a href="https://discord.gg/y7HpumjHeB" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">Discord</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M20.32 4.37a19.8 19.8 0 0 0-4.93-1.51 13.78 13.78 0 0 0-.64 1.28 18.27 18.27 0 0 0-5.5 0 12.64 12.64 0 0 0-.64-1.28h-.05A19.74 19.74 0 0 0 3.64 4.4 20.26 20.26 0 0 0 .11 18.09l.02.02a19.9 19.9 0 0 0 6.04 3.03l.04-.02a14.24 14.24 0 0 0 1.23-2.03.08.08 0 0 0-.05-.07 13.1 13.1 0 0 1-1.9-.92.08.08 0 0 1 .02-.1 10.2 10.2 0 0 0 .41-.31h.04a14.2 14.2 0 0 0 12.1 0l.04.01a9.63 9.63 0 0 0 .4.32.08.08 0 0 1-.03.1 12.29 12.29 0 0 1-1.9.91.08.08 0 0 0-.02.1 15.97 15.97 0 0 0 1.27 2.01h.04a19.84 19.84 0 0 0 6.03-3.05v-.03a20.12 20.12 0 0 0-3.57-13.69ZM8.02 15.33c-1.18 0-2.16-1.08-2.16-2.42 0-1.33.96-2.42 2.16-2.42 1.21 0 2.18 1.1 2.16 2.42 0 1.34-.96 2.42-2.16 2.42Zm7.97 0c-1.18 0-2.15-1.08-2.15-2.42 0-1.33.95-2.42 2.15-2.42 1.22 0 2.18 1.1 2.16 2.42 0 1.34-.94 2.42-2.16 2.42Z"/></svg></a><a href="https://github.com/microsoft/genaiscript" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">GitHub</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a><a href="https://www.youtube.com/@pelihalleux" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">YouTube</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M23.5 6.2A3 3 0 0 0 21.4 4c-1.9-.5-9.4-.5-9.4-.5s-7.5 0-9.4.5A3 3 0 0 0 .5 6.3C0 8 0 12 0 12s0 4 .5 5.8A3 3 0 0 0 2.6 20c1.9.6 9.4.6 9.4.6s7.5 0 9.4-.6a3 3 0 0 0 2.1-2c.5-2 .5-5.9.5-5.9s0-4-.5-5.8zm-14 9.4V8.4l6.3 3.6-6.3 3.6z"/></svg></a><a href="https://microsoft.github.io/genaiscript/blog/rss.xml" rel="me" class="sl-flex astro-s5lj4ku5"><span class="sr-only astro-s5lj4ku5">RSS</span><svg aria-hidden="true" class="astro-s5lj4ku5 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M2.88 16.88a3 3 0 0 0 0 4.24 3 3 0 0 0 4.24 0 3 3 0 0 0-4.24-4.24Zm2.83 2.83a1 1 0 0 1-1.42-1.42 1 1 0 0 1 1.42 0 1 1 0 0 1 0 1.42ZM5 12a1 1 0 0 0 0 2 5 5 0 0 1 5 5 1 1 0 0 0 2 0 7 7 0 0 0-7-7Zm0-4a1 1 0 0 0 0 2 9 9 0 0 1 9 9 1 1 0 0 0 2 0 11.08 11.08 0 0 0-3.22-7.78A11.08 11.08 0 0 0 5 8Zm10.61.39A15.11 15.11 0 0 0 5 4a1 1 0 0 0 0 2 13 13 0 0 1 13 13 1 1 0 0 0 2 0 15.11 15.11 0 0 0-4.39-10.61Z"/></svg></a> </div> <div class="astro-7ggugoi7"> <a href="/genaiscript/fr/blog/" class="astro-7ggugoi7">Blog</a> </div>  <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-bs72fung"> <span class="sr-only astro-bs72fung">Selectionner le thème</span> <svg aria-hidden="true" class="icon label-icon astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select value="auto" autocomplete="off" class="astro-bs72fung"> <option value="dark" class="astro-bs72fung">Sombre</option><option value="light" class="astro-bs72fung">Clair</option><option value="auto" selected class="astro-bs72fung">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>  <starlight-lang-select><label style="--sl-select-width: 7em" class="astro-bs72fung"> <span class="sr-only astro-bs72fung">Selectionner la langue</span> <svg aria-hidden="true" class="icon label-icon astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path fill-rule="evenodd" d="M8.516 3a.94.94 0 0 0-.941.94v1.15H2.94a.94.94 0 1 0 0 1.882h7.362a7.422 7.422 0 0 1-1.787 3.958 7.42 7.42 0 0 1-1.422-2.425.94.94 0 1 0-1.774.627 9.303 9.303 0 0 0 1.785 3.043 7.422 7.422 0 0 1-4.164 1.278.94.94 0 1 0 0 1.881 9.303 9.303 0 0 0 5.575-1.855 9.303 9.303 0 0 0 4.11 1.74l-.763 1.525a.968.968 0 0 0-.016.034l-1.385 2.77a.94.94 0 1 0 1.683.841l1.133-2.267h5.806l1.134 2.267a.94.94 0 0 0 1.683-.841l-1.385-2.769a.95.95 0 0 0-.018-.036l-3.476-6.951a.94.94 0 0 0-1.682 0l-1.82 3.639a7.423 7.423 0 0 1-3.593-1.256 9.303 9.303 0 0 0 2.27-5.203h1.894a.94.94 0 0 0 0-1.881H9.456V3.94A.94.94 0 0 0 8.516 3Zm6.426 11.794a1.068 1.068 0 0 1-.02.039l-.703 1.407h3.924l-1.962-3.924-1.24 2.478Z" clip-rule="evenodd"/></svg> <select value="/genaiscript/fr/blog/continuous-translations/" autocomplete="off" class="astro-bs72fung"> <option value="/genaiscript/blog/continuous-translations/" class="astro-bs72fung">English</option><option value="/genaiscript/fr/blog/continuous-translations/" selected class="astro-bs72fung">French</option> </select> <svg aria-hidden="true" class="icon caret astro-bs72fung astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label> </starlight-lang-select> </div>  </div> </div> </div> </nav> <div class="main-frame astro-w64kkxlm">  <script type="module">const a=document.getElementById("starlight__sidebar"),n=a?.querySelector("sl-sidebar-state-persist"),o="sl-sidebar-state",i=()=>{let t=[];const e=n?.dataset.hash||"";try{const s=sessionStorage.getItem(o),r=JSON.parse(s||"{}");Array.isArray(r.open)&&r.hash===e&&(t=r.open)}catch{}return{hash:e,open:t,scroll:a?.scrollTop||0}},c=t=>{try{sessionStorage.setItem(o,JSON.stringify(t))}catch{}},d=()=>c(i()),l=(t,e)=>{const s=i();s.open[e]=t,c(s)};n?.addEventListener("click",t=>{if(!(t.target instanceof Element))return;const e=t.target.closest("summary")?.closest("details");if(!e)return;const s=e.querySelector("sl-sidebar-restore"),r=parseInt(s?.dataset.index||"");isNaN(r)||l(!e.open,r)});addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&d()});addEventListener("pageHide",d);</script> <div class="lg:sl-flex astro-le5h5rmr"> <aside class="right-sidebar-container print:hidden astro-le5h5rmr"> <div class="right-sidebar astro-le5h5rmr"> <div class="lg:sl-hidden astro-l5ortwdx"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-jt7jxveb"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-jt7jxveb"><details id="starlight__mobile-toc" class="astro-jt7jxveb"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-jt7jxveb"><div class="toggle sl-flex astro-jt7jxveb">Sur cette page<svg aria-hidden="true" class="caret astro-jt7jxveb astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></div><span class="display-current astro-jt7jxveb"></span></summary><div class="dropdown astro-jt7jxveb"><ul class="isMobile astro-azuljrca" style="--depth: 0;"> <li class="astro-azuljrca" style="--depth: 0;"> <a href="#_top" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Vue d’ensemble</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#le-défi-de-la-traduction-de-la-documentation" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Le défi de la traduction de la documentation</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#traductions-markdown-itératives" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Traductions Markdown Itératives</span> </a> <ul class="isMobile astro-azuljrca" style="--depth: 1;"> <li class="astro-azuljrca" style="--depth: 1;"> <a href="#outils-ast-pour-markdown" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Outils AST pour Markdown</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#traductions-en-une-seule-passe" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Traductions en une seule passe</span> </a>  </li> </ul>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#évaluer-la-qualité-de-la-traduction" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Évaluer la qualité de la traduction</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#commit-et-push-des-modifications" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Commit et push des modifications</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#explication-détaillée-du-code" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Explication détaillée du code</span> </a> <ul class="isMobile astro-azuljrca" style="--depth: 1;"> <li class="astro-azuljrca" style="--depth: 1;"> <a href="#imports" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Imports</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#configuration-du-script" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Configuration du script</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#constantes-et-utilitaires" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Constantes et utilitaires</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#logique-principale-du-script" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Logique principale du script</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc><script type="module" src="/genaiscript/_astro/MobileTableOfContents.astro_astro_type_script_index_0_lang.C181hMzK.js"></script></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-l5ortwdx"><div class="sl-container astro-l5ortwdx"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">Sur cette page</h2><ul class="astro-azuljrca" style="--depth: 0;"> <li class="astro-azuljrca" style="--depth: 0;"> <a href="#_top" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Vue d’ensemble</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#le-défi-de-la-traduction-de-la-documentation" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Le défi de la traduction de la documentation</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#traductions-markdown-itératives" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Traductions Markdown Itératives</span> </a> <ul class="astro-azuljrca" style="--depth: 1;"> <li class="astro-azuljrca" style="--depth: 1;"> <a href="#outils-ast-pour-markdown" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Outils AST pour Markdown</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#traductions-en-une-seule-passe" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Traductions en une seule passe</span> </a>  </li> </ul>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#évaluer-la-qualité-de-la-traduction" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Évaluer la qualité de la traduction</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#commit-et-push-des-modifications" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Commit et push des modifications</span> </a>  </li><li class="astro-azuljrca" style="--depth: 0;"> <a href="#explication-détaillée-du-code" class="astro-azuljrca" style="--depth: 0;"> <span class="astro-azuljrca" style="--depth: 0;">Explication détaillée du code</span> </a> <ul class="astro-azuljrca" style="--depth: 1;"> <li class="astro-azuljrca" style="--depth: 1;"> <a href="#imports" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Imports</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#configuration-du-script" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Configuration du script</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#constantes-et-utilitaires" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Constantes et utilitaires</span> </a>  </li><li class="astro-azuljrca" style="--depth: 1;"> <a href="#logique-principale-du-script" class="astro-azuljrca" style="--depth: 1;"> <span class="astro-azuljrca" style="--depth: 1;">Logique principale du script</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc><script type="module" src="/genaiscript/_astro/TableOfContents.astro_astro_type_script_index_0_lang.CKWWgpjV.js"></script></div></div> </div> </aside> <div class="main-pane astro-le5h5rmr">  <main data-pagefind-body class="astro-xqcezzus" lang="fr" dir="ltr">    <div class="content-panel astro-4v724i2b"> <div class="sl-container astro-4v724i2b"> <h1 id="_top" class="astro-cyrdcjgw">Traductions Markdown Continues</h1>  <p class="sl-flex astro-gok2wwf2"> <svg aria-hidden="true" class="astro-gok2wwf2 astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-color: var(--sl-color-blue-high);--sl-icon-size: 1.5em;"><path d="M12 11a1 1 0 0 0-1 1v4a1 1 0 0 0 2 0v-4a1 1 0 0 0-1-1Zm.38-3.92a1 1 0 0 0-.76 0 1 1 0 0 0-.33.21 1.15 1.15 0 0 0-.21.33 1 1 0 0 0 .21 1.09c.097.088.209.16.33.21A1 1 0 0 0 13 8a1.05 1.05 0 0 0-.29-.71 1 1 0 0 0-.33-.21ZM12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18a8 8 0 1 1 0-16.001A8 8 0 0 1 12 20Z"/></svg>  <a href="https://github.com/microsoft/genaiscript/blob/dev/packages/sample/genaisrc/mdtranslator.genai.mts" class="astro-gok2wwf2">AI generated translation.</a> </p>  </div> </div>  <div class="content-panel astro-4v724i2b"> <div class="sl-container astro-4v724i2b"> <div class="sl-markdown-content"><figure class="astro-ekxpkj6h"> <img src="/genaiscript/_astro/continuous-translations.D6rBJQij_1Ev8ox.webp" alt="A visually bold, 8-bit style flowchart uses five simple colors to illustrate the journey of a Markdown document through multiple stages. It starts with the document turning into a blocky tree, then color-coded chunks are extracted. Placeholder tags are inserted before the process flows into a cloud icon (representing AI or cloud processing). Chunks reappear, now altered, and are put back into the document. The final output moves towards a stylized French flag. Icons like a disk for caching, a code block symbol, and a checkmark for quality control punctuate the diagram. There is no text or people; process steps are linked by basic geometric shapes and arrows." loading="eager" decoding="async" fetchpriority="auto" width="1143" height="762" class="astro-ekxpkj6h">  </figure> <div class="metadata not-content astro-tdhvzfxy"> <div class="dates astro-tdhvzfxy"> <time datetime="2025-07-02T00:00:00.000Z" class="astro-tdhvzfxy"> 2 juil. 2025 </time>    </div> <div class="authors astro-tdhvzfxy"> <a href="https://github.com/pelikhan" class="author astro-podjbdjp"><img src="https://avatars.githubusercontent.com/u/4175913?s=400&u=2aca7b068fa646da550c534145764d50f533561d&v=4" alt="Peli" loading="eager" decoding="async" fetchpriority="auto" width="40" height="40" class="astro-podjbdjp"><div class="text astro-podjbdjp"> <div class="name astro-podjbdjp">Peli</div> <div class="title astro-podjbdjp">GenAIScript developer</div> </div> </a>  </div>  </div>   <p>Vous avez peut-être remarqué que la documentation de GenAIScript est désormais disponible en <strong>français</strong> (essayez le menu déroulant de langue en haut à droite).</p>
<p>Les traductions ne sont pas un effort ponctuel ; elles sont mises à jour <strong>en continu</strong> à mesure que la documentation évolue, grâce à GitHub Actions. Cela signifie que chaque fois que du nouveau contenu est ajouté ou que du contenu existant est modifié,
les traductions sont automatiquement mises à jour pour refléter ces changements.</p>
<p>Dans cet article, nous allons passer en revue certains aspects intéressants du script et son fonctionnement.</p>
<aside aria-label="Note" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>Note</p><div class="starlight-aside__content"><p>The script in this blog is packaged as <a href="https://github.com/pelikhan/action-continuous-translation">custom github action</a>.</p></div></aside>
<div class="sl-heading-wrapper level-h2"><h2 id="le-défi-de-la-traduction-de-la-documentation">Le défi de la traduction de la documentation</h2><a class="sl-anchor-link" href="#le-défi-de-la-traduction-de-la-documentation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Le défi de la traduction de la documentation »</span></a></div>
<p>L’objectif de ce défi est de maintenir une documentation localisée, et d’automatiser le processus grâce à GenAIScript, GitHub Actions et GitHub Models.
Pour réussir, nous avons besoin :</p>
<ul>
<li>d’un modèle capable de produire des traductions de haute qualité (les LLMs comme <code dir="auto">gpt-4o</code> et supérieurs sont devenus assez efficaces pour cela),</li>
<li>d’une stratégie itérative pour traduire partiellement les parties modifiées d’un fichier markdown. Nous ne pouvons pas simplement traduire tout un fichier car les traductions changeraient à chaque itération.</li>
<li>d’idempotence : si les traductions sont déjà disponibles, les résultats doivent être mis en cache et le script ne doit effectuer aucune action.</li>
<li>d’une exécution automatique via une GitHub Action et de l’utilisation de GitHub Models pour l’inférence.</li>
</ul>
<p>C’est parti ! Si vous souhaitez consulter le code, <a href="https://github.com/microsoft/genaiscript/blob/dev/packages/sample/genaisrc/mdtranslator.genai.mts">voici le script</a>.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="traductions-markdown-itératives">Traductions Markdown Itératives</h2><a class="sl-anchor-link" href="#traductions-markdown-itératives"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Traductions Markdown Itératives »</span></a></div>
<p>Comme GenAIScript utilise le markdown pour la documentation, nous allons nous concentrer exclusivement sur ce format de fichier. GenAIScript utilise aussi <a href="https://starlight.astro.build/">Astro Starlight</a> qui ajoute des métadonnées bien connues dans le frontmatter comme <code dir="auto">title</code> ou <code dir="auto">description</code>.</p>
<p>L’idée principale derrière les scripts de traduction est la suivante :</p>
<ul>
<li>analyser le document markdown en un AST (Abstract Syntax Tree)</li>
<li>parcourir l’arbre et collecter tous les blocs de texte traduisibles (attention particulière aux paragraphes)</li>
<li>remplacer tous les blocs traduisibles par un placeholder, par exemple <code dir="auto">[T001]bla bla bla...[T002]</code>, et demander au LLM de traduire chaque bloc</li>
<li>analyser la réponse du LLM, extraire chaque traduction de bloc, et revisiter l’arbre pour appliquer les traductions</li>
<li>évaluer la qualité de la traduction</li>
<li>sauvegarder les traductions dans un cache afin de les réutiliser lors d’une prochaine exécution</li>
</ul>
<picture><source height="694" id="mermaid-dark-0" media="(prefers-color-scheme: dark)" srcset="data:image/svg+xml,%3csvg%20aria-roledescription=&#x27;flowchart-v2&#x27;%20role=&#x27;graphics-document%20document&#x27;%20viewBox=&#x27;0%200%20374.7300109863281%20694&#x27;%20style=&#x27;max-width:%20374.7300109863281px%3b&#x27;%20class=&#x27;flowchart&#x27;%20xmlns:xlink=&#x27;http://www.w3.org/1999/xlink&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;100%25&#x27;%20id=&#x27;mermaid-dark-0&#x27;%3e%3cstyle%3e%23mermaid-dark-0%7bfont-family:arial%2csans-serif%3bfont-size:16px%3bfill:%23ccc%3b%7d%40keyframes%20edge-animation-frame%7bfrom%7bstroke-dashoffset:0%3b%7d%7d%40keyframes%20dash%7bto%7bstroke-dashoffset:0%3b%7d%7d%23mermaid-dark-0%20.edge-animation-slow%7bstroke-dasharray:9%2c5!important%3bstroke-dashoffset:900%3banimation:dash%2050s%20linear%20infinite%3bstroke-linecap:round%3b%7d%23mermaid-dark-0%20.edge-animation-fast%7bstroke-dasharray:9%2c5!important%3bstroke-dashoffset:900%3banimation:dash%2020s%20linear%20infinite%3bstroke-linecap:round%3b%7d%23mermaid-dark-0%20.error-icon%7bfill:%23a44141%3b%7d%23mermaid-dark-0%20.error-text%7bfill:%23ddd%3bstroke:%23ddd%3b%7d%23mermaid-dark-0%20.edge-thickness-normal%7bstroke-width:1px%3b%7d%23mermaid-dark-0%20.edge-thickness-thick%7bstroke-width:3.5px%3b%7d%23mermaid-dark-0%20.edge-pattern-solid%7bstroke-dasharray:0%3b%7d%23mermaid-dark-0%20.edge-thickness-invisible%7bstroke-width:0%3bfill:none%3b%7d%23mermaid-dark-0%20.edge-pattern-dashed%7bstroke-dasharray:3%3b%7d%23mermaid-dark-0%20.edge-pattern-dotted%7bstroke-dasharray:2%3b%7d%23mermaid-dark-0%20.marker%7bfill:lightgrey%3bstroke:lightgrey%3b%7d%23mermaid-dark-0%20.marker.cross%7bstroke:lightgrey%3b%7d%23mermaid-dark-0%20svg%7bfont-family:arial%2csans-serif%3bfont-size:16px%3b%7d%23mermaid-dark-0%20p%7bmargin:0%3b%7d%23mermaid-dark-0%20.label%7bfont-family:arial%2csans-serif%3bcolor:%23ccc%3b%7d%23mermaid-dark-0%20.cluster-label%20text%7bfill:%23F9FFFE%3b%7d%23mermaid-dark-0%20.cluster-label%20span%7bcolor:%23F9FFFE%3b%7d%23mermaid-dark-0%20.cluster-label%20span%20p%7bbackground-color:transparent%3b%7d%23mermaid-dark-0%20.label%20text%2c%23mermaid-dark-0%20span%7bfill:%23ccc%3bcolor:%23ccc%3b%7d%23mermaid-dark-0%20.node%20rect%2c%23mermaid-dark-0%20.node%20circle%2c%23mermaid-dark-0%20.node%20ellipse%2c%23mermaid-dark-0%20.node%20polygon%2c%23mermaid-dark-0%20.node%20path%7bfill:%231f2020%3bstroke:%23ccc%3bstroke-width:1px%3b%7d%23mermaid-dark-0%20.rough-node%20.label%20text%2c%23mermaid-dark-0%20.node%20.label%20text%2c%23mermaid-dark-0%20.image-shape%20.label%2c%23mermaid-dark-0%20.icon-shape%20.label%7btext-anchor:middle%3b%7d%23mermaid-dark-0%20.node%20.katex%20path%7bfill:black%3bstroke:black%3bstroke-width:1px%3b%7d%23mermaid-dark-0%20.rough-node%20.label%2c%23mermaid-dark-0%20.node%20.label%2c%23mermaid-dark-0%20.image-shape%20.label%2c%23mermaid-dark-0%20.icon-shape%20.label%7btext-align:center%3b%7d%23mermaid-dark-0%20.node.clickable%7bcursor:pointer%3b%7d%23mermaid-dark-0%20.root%20.anchor%20path%7bfill:lightgrey!important%3bstroke-width:0%3bstroke:lightgrey%3b%7d%23mermaid-dark-0%20.arrowheadPath%7bfill:lightgrey%3b%7d%23mermaid-dark-0%20.edgePath%20.path%7bstroke:lightgrey%3bstroke-width:2.0px%3b%7d%23mermaid-dark-0%20.flowchart-link%7bstroke:lightgrey%3bfill:none%3b%7d%23mermaid-dark-0%20.edgeLabel%7bbackground-color:hsl(0%2c%200%25%2c%2034.4117647059%25)%3btext-align:center%3b%7d%23mermaid-dark-0%20.edgeLabel%20p%7bbackground-color:hsl(0%2c%200%25%2c%2034.4117647059%25)%3b%7d%23mermaid-dark-0%20.edgeLabel%20rect%7bopacity:0.5%3bbackground-color:hsl(0%2c%200%25%2c%2034.4117647059%25)%3bfill:hsl(0%2c%200%25%2c%2034.4117647059%25)%3b%7d%23mermaid-dark-0%20.labelBkg%7bbackground-color:rgba(87.75%2c%2087.75%2c%2087.75%2c%200.5)%3b%7d%23mermaid-dark-0%20.cluster%20rect%7bfill:hsl(180%2c%201.5873015873%25%2c%2028.3529411765%25)%3bstroke:rgba(255%2c%20255%2c%20255%2c%200.25)%3bstroke-width:1px%3b%7d%23mermaid-dark-0%20.cluster%20text%7bfill:%23F9FFFE%3b%7d%23mermaid-dark-0%20.cluster%20span%7bcolor:%23F9FFFE%3b%7d%23mermaid-dark-0%20div.mermaidTooltip%7bposition:absolute%3btext-align:center%3bmax-width:200px%3bpadding:2px%3bfont-family:arial%2csans-serif%3bfont-size:12px%3bbackground:hsl(20%2c%201.5873015873%25%2c%2012.3529411765%25)%3bborder:1px%20solid%20rgba(255%2c%20255%2c%20255%2c%200.25)%3bborder-radius:2px%3bpointer-events:none%3bz-index:100%3b%7d%23mermaid-dark-0%20.flowchartTitleText%7btext-anchor:middle%3bfont-size:18px%3bfill:%23ccc%3b%7d%23mermaid-dark-0%20rect.text%7bfill:none%3bstroke-width:0%3b%7d%23mermaid-dark-0%20.icon-shape%2c%23mermaid-dark-0%20.image-shape%7bbackground-color:hsl(0%2c%200%25%2c%2034.4117647059%25)%3btext-align:center%3b%7d%23mermaid-dark-0%20.icon-shape%20p%2c%23mermaid-dark-0%20.image-shape%20p%7bbackground-color:hsl(0%2c%200%25%2c%2034.4117647059%25)%3bpadding:2px%3b%7d%23mermaid-dark-0%20.icon-shape%20rect%2c%23mermaid-dark-0%20.image-shape%20rect%7bopacity:0.5%3bbackground-color:hsl(0%2c%200%25%2c%2034.4117647059%25)%3bfill:hsl(0%2c%200%25%2c%2034.4117647059%25)%3b%7d%23mermaid-dark-0%20.label-icon%7bdisplay:inline-block%3bheight:1em%3boverflow:visible%3bvertical-align:-0.125em%3b%7d%23mermaid-dark-0%20.node%20.label-icon%20path%7bfill:currentColor%3bstroke:revert%3bstroke-width:revert%3b%7d%23mermaid-dark-0%20:root%7b--mermaid-font-family:arial%2csans-serif%3b%7d%3c/style%3e%3cg%3e%3cmarker%20orient=&#x27;auto&#x27;%20markerHeight=&#x27;8&#x27;%20markerWidth=&#x27;8&#x27;%20markerUnits=&#x27;userSpaceOnUse&#x27;%20refY=&#x27;5&#x27;%20refX=&#x27;5&#x27;%20viewBox=&#x27;0%200%2010%2010&#x27;%20class=&#x27;marker%20flowchart-v2&#x27;%20id=&#x27;mermaid-dark-0_flowchart-v2-pointEnd&#x27;%3e%3cpath%20style=&#x27;stroke-width:%201%3b%20stroke-dasharray:%201%2c%200%3b&#x27;%20class=&#x27;arrowMarkerPath&#x27;%20d=&#x27;M%200%200%20L%2010%205%20L%200%2010%20z&#x27;/%3e%3c/marker%3e%3cmarker%20orient=&#x27;auto&#x27;%20markerHeight=&#x27;8&#x27;%20markerWidth=&#x27;8&#x27;%20markerUnits=&#x27;userSpaceOnUse&#x27;%20refY=&#x27;5&#x27;%20refX=&#x27;4.5&#x27;%20viewBox=&#x27;0%200%2010%2010&#x27;%20class=&#x27;marker%20flowchart-v2&#x27;%20id=&#x27;mermaid-dark-0_flowchart-v2-pointStart&#x27;%3e%3cpath%20style=&#x27;stroke-width:%201%3b%20stroke-dasharray:%201%2c%200%3b&#x27;%20class=&#x27;arrowMarkerPath&#x27;%20d=&#x27;M%200%205%20L%2010%2010%20L%2010%200%20z&#x27;/%3e%3c/marker%3e%3cmarker%20orient=&#x27;auto&#x27;%20markerHeight=&#x27;11&#x27;%20markerWidth=&#x27;11&#x27;%20markerUnits=&#x27;userSpaceOnUse&#x27;%20refY=&#x27;5&#x27;%20refX=&#x27;11&#x27;%20viewBox=&#x27;0%200%2010%2010&#x27;%20class=&#x27;marker%20flowchart-v2&#x27;%20id=&#x27;mermaid-dark-0_flowchart-v2-circleEnd&#x27;%3e%3ccircle%20style=&#x27;stroke-width:%201%3b%20stroke-dasharray:%201%2c%200%3b&#x27;%20class=&#x27;arrowMarkerPath&#x27;%20r=&#x27;5&#x27;%20cy=&#x27;5&#x27;%20cx=&#x27;5&#x27;/%3e%3c/marker%3e%3cmarker%20orient=&#x27;auto&#x27;%20markerHeight=&#x27;11&#x27;%20markerWidth=&#x27;11&#x27;%20markerUnits=&#x27;userSpaceOnUse&#x27;%20refY=&#x27;5&#x27;%20refX=&#x27;-1&#x27;%20viewBox=&#x27;0%200%2010%2010&#x27;%20class=&#x27;marker%20flowchart-v2&#x27;%20id=&#x27;mermaid-dark-0_flowchart-v2-circleStart&#x27;%3e%3ccircle%20style=&#x27;stroke-width:%201%3b%20stroke-dasharray:%201%2c%200%3b&#x27;%20class=&#x27;arrowMarkerPath&#x27;%20r=&#x27;5&#x27;%20cy=&#x27;5&#x27;%20cx=&#x27;5&#x27;/%3e%3c/marker%3e%3cmarker%20orient=&#x27;auto&#x27;%20markerHeight=&#x27;11&#x27;%20markerWidth=&#x27;11&#x27;%20markerUnits=&#x27;userSpaceOnUse&#x27;%20refY=&#x27;5.2&#x27;%20refX=&#x27;12&#x27;%20viewBox=&#x27;0%200%2011%2011&#x27;%20class=&#x27;marker%20cross%20flowchart-v2&#x27;%20id=&#x27;mermaid-dark-0_flowchart-v2-crossEnd&#x27;%3e%3cpath%20style=&#x27;stroke-width:%202%3b%20stroke-dasharray:%201%2c%200%3b&#x27;%20class=&#x27;arrowMarkerPath&#x27;%20d=&#x27;M%201%2c1%20l%209%2c9%20M%2010%2c1%20l%20-9%2c9&#x27;/%3e%3c/marker%3e%3cmarker%20orient=&#x27;auto&#x27;%20markerHeight=&#x27;11&#x27;%20markerWidth=&#x27;11&#x27;%20markerUnits=&#x27;userSpaceOnUse&#x27;%20refY=&#x27;5.2&#x27;%20refX=&#x27;-1&#x27;%20viewBox=&#x27;0%200%2011%2011&#x27;%20class=&#x27;marker%20cross%20flowchart-v2&#x27;%20id=&#x27;mermaid-dark-0_flowchart-v2-crossStart&#x27;%3e%3cpath%20style=&#x27;stroke-width:%202%3b%20stroke-dasharray:%201%2c%200%3b&#x27;%20class=&#x27;arrowMarkerPath&#x27;%20d=&#x27;M%201%2c1%20l%209%2c9%20M%2010%2c1%20l%20-9%2c9&#x27;/%3e%3c/marker%3e%3cg%20class=&#x27;root&#x27;%3e%3cg%20class=&#x27;clusters&#x27;/%3e%3cg%20class=&#x27;edgePaths&#x27;%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_A_B_0&#x27;%20d=&#x27;M211.91%2c62L211.91%2c66.167C211.91%2c70.333%2c211.91%2c78.667%2c211.91%2c86.333C211.91%2c94%2c211.91%2c101%2c211.91%2c104.5L211.91%2c108&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_B_C_0&#x27;%20d=&#x27;M170.56%2c166L164.179%2c170.167C157.798%2c174.333%2c145.036%2c182.667%2c138.655%2c190.333C132.273%2c198%2c132.273%2c205%2c132.273%2c208.5L132.273%2c212&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_C_D_0&#x27;%20d=&#x27;M132.273%2c270L132.273%2c274.167C132.273%2c278.333%2c132.273%2c286.667%2c132.273%2c294.333C132.273%2c302%2c132.273%2c309%2c132.273%2c312.5L132.273%2c316&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_D_E_0&#x27;%20d=&#x27;M132.273%2c374L132.273%2c378.167C132.273%2c382.333%2c132.273%2c390.667%2c138.096%2c398.636C143.919%2c406.604%2c155.565%2c414.209%2c161.388%2c418.011L167.211%2c421.813&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_E_J_0&#x27;%20d=&#x27;M211.91%2c478L211.91%2c482.167C211.91%2c486.333%2c211.91%2c494.667%2c216.612%2c502.584C221.314%2c510.502%2c230.718%2c518.004%2c235.42%2c521.755L240.122%2c525.506&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_J_C_0&#x27;%20d=&#x27;M323.636%2c528L330.818%2c523.833C338.001%2c519.667%2c352.366%2c511.333%2c359.548%2c498.5C366.73%2c485.667%2c366.73%2c468.333%2c366.73%2c451C366.73%2c433.667%2c366.73%2c416.333%2c366.73%2c399C366.73%2c381.667%2c366.73%2c364.333%2c366.73%2c347C366.73%2c329.667%2c366.73%2c312.333%2c348.595%2c299.644C330.459%2c286.955%2c294.187%2c278.911%2c276.052%2c274.888L257.916%2c270.866&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_J_F_0&#x27;%20d=&#x27;M277.094%2c582L277.094%2c586.167C277.094%2c590.333%2c277.094%2c598.667%2c277.094%2c606.333C277.094%2c614%2c277.094%2c621%2c277.094%2c624.5L277.094%2c628&#x27;/%3e%3cpath%20marker-end=&#x27;url(%23mermaid-dark-0_flowchart-v2-pointEnd)&#x27;%20style=&#x27;&#x27;%20class=&#x27;edge-thickness-normal%20edge-pattern-solid%20edge-thickness-normal%20edge-pattern-solid%20flowchart-link&#x27;%20id=&#x27;L_E_B_0&#x27;%20d=&#x27;M253.26%2c424L259.641%2c419.833C266.022%2c415.667%2c278.785%2c407.333%2c285.166%2c394.5C291.547%2c381.667%2c291.547%2c364.333%2c291.547%2c347C291.547%2c329.667%2c291.547%2c312.333%2c291.547%2c295C291.547%2c277.667%2c291.547%2c260.333%2c291.547%2c243C291.547%2c225.667%2c291.547%2c208.333%2c285.724%2c195.864C279.901%2c183.396%2c268.255%2c175.791%2c262.432%2c171.989L256.609%2c168.187&#x27;/%3e%3c/g%3e%3cg%20class=&#x27;edgeLabels&#x27;%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;edgeLabel&#x27;%3e%3cg%20transform=&#x27;translate(0%2c%200)&#x27;%20class=&#x27;label&#x27;%3e%3cforeignObject%20height=&#x27;0&#x27;%20width=&#x27;0&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20class=&#x27;labelBkg&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3c/g%3e%3cg%20class=&#x27;nodes&#x27;%3e%3cg%20transform=&#x27;translate(211.91015625%2c%2035)&#x27;%20id=&#x27;flowchart-A-0&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;180.046875&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-90.0234375&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-60.0234375%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;120.046875&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eParse%20Markdown%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20transform=&#x27;translate(211.91015625%2c%20139)&#x27;%20id=&#x27;flowchart-B-1&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;167.609375&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-83.8046875&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-53.8046875%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;107.609375&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eCollect%20Chunks%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20transform=&#x27;translate(132.2734375%2c%20243)&#x27;%20id=&#x27;flowchart-C-3&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;248.546875&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-124.2734375&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-94.2734375%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;188.546875&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eReplace%20with%20Placeholders%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20transform=&#x27;translate(132.2734375%2c%20347)&#x27;%20id=&#x27;flowchart-D-5&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;184.796875&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-92.3984375&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-62.3984375%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;124.796875&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eTranslate%20Chunks%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20transform=&#x27;translate(211.91015625%2c%20451)&#x27;%20id=&#x27;flowchart-E-7&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;190.734375&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-95.3671875&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-65.3671875%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;130.734375&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eApply%20Translations%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20transform=&#x27;translate(277.09375%2c%20555)&#x27;%20id=&#x27;flowchart-J-9&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;157.84375&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-78.921875&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-48.921875%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;97.84375&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eJudge%20Quality%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg%20transform=&#x27;translate(277.09375%2c%20659)&#x27;%20id=&#x27;flowchart-F-13&#x27;%20class=&#x27;node%20default&#x27;%3e%3crect%20height=&#x27;54&#x27;%20width=&#x27;164.953125&#x27;%20y=&#x27;-27&#x27;%20x=&#x27;-82.4765625&#x27;%20style=&#x27;&#x27;%20class=&#x27;basic%20label-container&#x27;/%3e%3cg%20transform=&#x27;translate(-52.4765625%2c%20-12)&#x27;%20style=&#x27;&#x27;%20class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject%20height=&#x27;24&#x27;%20width=&#x27;104.953125&#x27;%3e%3cdiv%20style=&#x27;display:%20table-cell%3b%20white-space:%20nowrap%3b%20line-height:%201.5%3b%20max-width:%20200px%3b%20text-align:%20center%3b&#x27;%20xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan%20class=&#x27;nodeLabel&#x27;%3e%3cp%3eSave%20to%20Cache%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e" width="374.7300109863281"><img alt="" height="694" id="mermaid-0" src="data:image/svg+xml,%3csvg aria-roledescription=&#x27;flowchart-v2&#x27; role=&#x27;graphics-document document&#x27; viewBox=&#x27;0 0 374.7300109863281 694&#x27; style=&#x27;max-width: 374.7300109863281px%3b&#x27; class=&#x27;flowchart&#x27; xmlns:xlink=&#x27;http://www.w3.org/1999/xlink&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; width=&#x27;100%25&#x27; id=&#x27;mermaid-0&#x27;%3e%3cstyle%3e%23mermaid-0%7bfont-family:arial%2csans-serif%3bfont-size:16px%3bfill:%23333%3b%7d%40keyframes edge-animation-frame%7bfrom%7bstroke-dashoffset:0%3b%7d%7d%40keyframes dash%7bto%7bstroke-dashoffset:0%3b%7d%7d%23mermaid-0 .edge-animation-slow%7bstroke-dasharray:9%2c5!important%3bstroke-dashoffset:900%3banimation:dash 50s linear infinite%3bstroke-linecap:round%3b%7d%23mermaid-0 .edge-animation-fast%7bstroke-dasharray:9%2c5!important%3bstroke-dashoffset:900%3banimation:dash 20s linear infinite%3bstroke-linecap:round%3b%7d%23mermaid-0 .error-icon%7bfill:%23552222%3b%7d%23mermaid-0 .error-text%7bfill:%23552222%3bstroke:%23552222%3b%7d%23mermaid-0 .edge-thickness-normal%7bstroke-width:1px%3b%7d%23mermaid-0 .edge-thickness-thick%7bstroke-width:3.5px%3b%7d%23mermaid-0 .edge-pattern-solid%7bstroke-dasharray:0%3b%7d%23mermaid-0 .edge-thickness-invisible%7bstroke-width:0%3bfill:none%3b%7d%23mermaid-0 .edge-pattern-dashed%7bstroke-dasharray:3%3b%7d%23mermaid-0 .edge-pattern-dotted%7bstroke-dasharray:2%3b%7d%23mermaid-0 .marker%7bfill:%23333333%3bstroke:%23333333%3b%7d%23mermaid-0 .marker.cross%7bstroke:%23333333%3b%7d%23mermaid-0 svg%7bfont-family:arial%2csans-serif%3bfont-size:16px%3b%7d%23mermaid-0 p%7bmargin:0%3b%7d%23mermaid-0 .label%7bfont-family:arial%2csans-serif%3bcolor:%23333%3b%7d%23mermaid-0 .cluster-label text%7bfill:%23333%3b%7d%23mermaid-0 .cluster-label span%7bcolor:%23333%3b%7d%23mermaid-0 .cluster-label span p%7bbackground-color:transparent%3b%7d%23mermaid-0 .label text%2c%23mermaid-0 span%7bfill:%23333%3bcolor:%23333%3b%7d%23mermaid-0 .node rect%2c%23mermaid-0 .node circle%2c%23mermaid-0 .node ellipse%2c%23mermaid-0 .node polygon%2c%23mermaid-0 .node path%7bfill:%23ECECFF%3bstroke:%239370DB%3bstroke-width:1px%3b%7d%23mermaid-0 .rough-node .label text%2c%23mermaid-0 .node .label text%2c%23mermaid-0 .image-shape .label%2c%23mermaid-0 .icon-shape .label%7btext-anchor:middle%3b%7d%23mermaid-0 .node .katex path%7bfill:black%3bstroke:black%3bstroke-width:1px%3b%7d%23mermaid-0 .rough-node .label%2c%23mermaid-0 .node .label%2c%23mermaid-0 .image-shape .label%2c%23mermaid-0 .icon-shape .label%7btext-align:center%3b%7d%23mermaid-0 .node.clickable%7bcursor:pointer%3b%7d%23mermaid-0 .root .anchor path%7bfill:%23333333!important%3bstroke-width:0%3bstroke:%23333333%3b%7d%23mermaid-0 .arrowheadPath%7bfill:%23333333%3b%7d%23mermaid-0 .edgePath .path%7bstroke:%23333333%3bstroke-width:2.0px%3b%7d%23mermaid-0 .flowchart-link%7bstroke:%23333333%3bfill:none%3b%7d%23mermaid-0 .edgeLabel%7bbackground-color:rgba(232%2c232%2c232%2c 0.8)%3btext-align:center%3b%7d%23mermaid-0 .edgeLabel p%7bbackground-color:rgba(232%2c232%2c232%2c 0.8)%3b%7d%23mermaid-0 .edgeLabel rect%7bopacity:0.5%3bbackground-color:rgba(232%2c232%2c232%2c 0.8)%3bfill:rgba(232%2c232%2c232%2c 0.8)%3b%7d%23mermaid-0 .labelBkg%7bbackground-color:rgba(232%2c 232%2c 232%2c 0.5)%3b%7d%23mermaid-0 .cluster rect%7bfill:%23ffffde%3bstroke:%23aaaa33%3bstroke-width:1px%3b%7d%23mermaid-0 .cluster text%7bfill:%23333%3b%7d%23mermaid-0 .cluster span%7bcolor:%23333%3b%7d%23mermaid-0 div.mermaidTooltip%7bposition:absolute%3btext-align:center%3bmax-width:200px%3bpadding:2px%3bfont-family:arial%2csans-serif%3bfont-size:12px%3bbackground:hsl(80%2c 100%25%2c 96.2745098039%25)%3bborder:1px solid %23aaaa33%3bborder-radius:2px%3bpointer-events:none%3bz-index:100%3b%7d%23mermaid-0 .flowchartTitleText%7btext-anchor:middle%3bfont-size:18px%3bfill:%23333%3b%7d%23mermaid-0 rect.text%7bfill:none%3bstroke-width:0%3b%7d%23mermaid-0 .icon-shape%2c%23mermaid-0 .image-shape%7bbackground-color:rgba(232%2c232%2c232%2c 0.8)%3btext-align:center%3b%7d%23mermaid-0 .icon-shape p%2c%23mermaid-0 .image-shape p%7bbackground-color:rgba(232%2c232%2c232%2c 0.8)%3bpadding:2px%3b%7d%23mermaid-0 .icon-shape rect%2c%23mermaid-0 .image-shape rect%7bopacity:0.5%3bbackground-color:rgba(232%2c232%2c232%2c 0.8)%3bfill:rgba(232%2c232%2c232%2c 0.8)%3b%7d%23mermaid-0 .label-icon%7bdisplay:inline-block%3bheight:1em%3boverflow:visible%3bvertical-align:-0.125em%3b%7d%23mermaid-0 .node .label-icon path%7bfill:currentColor%3bstroke:revert%3bstroke-width:revert%3b%7d%23mermaid-0 :root%7b--mermaid-font-family:arial%2csans-serif%3b%7d%3c/style%3e%3cg%3e%3cmarker orient=&#x27;auto&#x27; markerHeight=&#x27;8&#x27; markerWidth=&#x27;8&#x27; markerUnits=&#x27;userSpaceOnUse&#x27; refY=&#x27;5&#x27; refX=&#x27;5&#x27; viewBox=&#x27;0 0 10 10&#x27; class=&#x27;marker flowchart-v2&#x27; id=&#x27;mermaid-0_flowchart-v2-pointEnd&#x27;%3e%3cpath style=&#x27;stroke-width: 1%3b stroke-dasharray: 1%2c 0%3b&#x27; class=&#x27;arrowMarkerPath&#x27; d=&#x27;M 0 0 L 10 5 L 0 10 z&#x27;/%3e%3c/marker%3e%3cmarker orient=&#x27;auto&#x27; markerHeight=&#x27;8&#x27; markerWidth=&#x27;8&#x27; markerUnits=&#x27;userSpaceOnUse&#x27; refY=&#x27;5&#x27; refX=&#x27;4.5&#x27; viewBox=&#x27;0 0 10 10&#x27; class=&#x27;marker flowchart-v2&#x27; id=&#x27;mermaid-0_flowchart-v2-pointStart&#x27;%3e%3cpath style=&#x27;stroke-width: 1%3b stroke-dasharray: 1%2c 0%3b&#x27; class=&#x27;arrowMarkerPath&#x27; d=&#x27;M 0 5 L 10 10 L 10 0 z&#x27;/%3e%3c/marker%3e%3cmarker orient=&#x27;auto&#x27; markerHeight=&#x27;11&#x27; markerWidth=&#x27;11&#x27; markerUnits=&#x27;userSpaceOnUse&#x27; refY=&#x27;5&#x27; refX=&#x27;11&#x27; viewBox=&#x27;0 0 10 10&#x27; class=&#x27;marker flowchart-v2&#x27; id=&#x27;mermaid-0_flowchart-v2-circleEnd&#x27;%3e%3ccircle style=&#x27;stroke-width: 1%3b stroke-dasharray: 1%2c 0%3b&#x27; class=&#x27;arrowMarkerPath&#x27; r=&#x27;5&#x27; cy=&#x27;5&#x27; cx=&#x27;5&#x27;/%3e%3c/marker%3e%3cmarker orient=&#x27;auto&#x27; markerHeight=&#x27;11&#x27; markerWidth=&#x27;11&#x27; markerUnits=&#x27;userSpaceOnUse&#x27; refY=&#x27;5&#x27; refX=&#x27;-1&#x27; viewBox=&#x27;0 0 10 10&#x27; class=&#x27;marker flowchart-v2&#x27; id=&#x27;mermaid-0_flowchart-v2-circleStart&#x27;%3e%3ccircle style=&#x27;stroke-width: 1%3b stroke-dasharray: 1%2c 0%3b&#x27; class=&#x27;arrowMarkerPath&#x27; r=&#x27;5&#x27; cy=&#x27;5&#x27; cx=&#x27;5&#x27;/%3e%3c/marker%3e%3cmarker orient=&#x27;auto&#x27; markerHeight=&#x27;11&#x27; markerWidth=&#x27;11&#x27; markerUnits=&#x27;userSpaceOnUse&#x27; refY=&#x27;5.2&#x27; refX=&#x27;12&#x27; viewBox=&#x27;0 0 11 11&#x27; class=&#x27;marker cross flowchart-v2&#x27; id=&#x27;mermaid-0_flowchart-v2-crossEnd&#x27;%3e%3cpath style=&#x27;stroke-width: 2%3b stroke-dasharray: 1%2c 0%3b&#x27; class=&#x27;arrowMarkerPath&#x27; d=&#x27;M 1%2c1 l 9%2c9 M 10%2c1 l -9%2c9&#x27;/%3e%3c/marker%3e%3cmarker orient=&#x27;auto&#x27; markerHeight=&#x27;11&#x27; markerWidth=&#x27;11&#x27; markerUnits=&#x27;userSpaceOnUse&#x27; refY=&#x27;5.2&#x27; refX=&#x27;-1&#x27; viewBox=&#x27;0 0 11 11&#x27; class=&#x27;marker cross flowchart-v2&#x27; id=&#x27;mermaid-0_flowchart-v2-crossStart&#x27;%3e%3cpath style=&#x27;stroke-width: 2%3b stroke-dasharray: 1%2c 0%3b&#x27; class=&#x27;arrowMarkerPath&#x27; d=&#x27;M 1%2c1 l 9%2c9 M 10%2c1 l -9%2c9&#x27;/%3e%3c/marker%3e%3cg class=&#x27;root&#x27;%3e%3cg class=&#x27;clusters&#x27;/%3e%3cg class=&#x27;edgePaths&#x27;%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_A_B_0&#x27; d=&#x27;M211.91%2c62L211.91%2c66.167C211.91%2c70.333%2c211.91%2c78.667%2c211.91%2c86.333C211.91%2c94%2c211.91%2c101%2c211.91%2c104.5L211.91%2c108&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_B_C_0&#x27; d=&#x27;M170.56%2c166L164.179%2c170.167C157.798%2c174.333%2c145.036%2c182.667%2c138.655%2c190.333C132.273%2c198%2c132.273%2c205%2c132.273%2c208.5L132.273%2c212&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_C_D_0&#x27; d=&#x27;M132.273%2c270L132.273%2c274.167C132.273%2c278.333%2c132.273%2c286.667%2c132.273%2c294.333C132.273%2c302%2c132.273%2c309%2c132.273%2c312.5L132.273%2c316&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_D_E_0&#x27; d=&#x27;M132.273%2c374L132.273%2c378.167C132.273%2c382.333%2c132.273%2c390.667%2c138.096%2c398.636C143.919%2c406.604%2c155.565%2c414.209%2c161.388%2c418.011L167.211%2c421.813&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_E_J_0&#x27; d=&#x27;M211.91%2c478L211.91%2c482.167C211.91%2c486.333%2c211.91%2c494.667%2c216.612%2c502.584C221.314%2c510.502%2c230.718%2c518.004%2c235.42%2c521.755L240.122%2c525.506&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_J_C_0&#x27; d=&#x27;M323.636%2c528L330.818%2c523.833C338.001%2c519.667%2c352.366%2c511.333%2c359.548%2c498.5C366.73%2c485.667%2c366.73%2c468.333%2c366.73%2c451C366.73%2c433.667%2c366.73%2c416.333%2c366.73%2c399C366.73%2c381.667%2c366.73%2c364.333%2c366.73%2c347C366.73%2c329.667%2c366.73%2c312.333%2c348.595%2c299.644C330.459%2c286.955%2c294.187%2c278.911%2c276.052%2c274.888L257.916%2c270.866&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_J_F_0&#x27; d=&#x27;M277.094%2c582L277.094%2c586.167C277.094%2c590.333%2c277.094%2c598.667%2c277.094%2c606.333C277.094%2c614%2c277.094%2c621%2c277.094%2c624.5L277.094%2c628&#x27;/%3e%3cpath marker-end=&#x27;url(%23mermaid-0_flowchart-v2-pointEnd)&#x27; style=&#x27;&#x27; class=&#x27;edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link&#x27; id=&#x27;L_E_B_0&#x27; d=&#x27;M253.26%2c424L259.641%2c419.833C266.022%2c415.667%2c278.785%2c407.333%2c285.166%2c394.5C291.547%2c381.667%2c291.547%2c364.333%2c291.547%2c347C291.547%2c329.667%2c291.547%2c312.333%2c291.547%2c295C291.547%2c277.667%2c291.547%2c260.333%2c291.547%2c243C291.547%2c225.667%2c291.547%2c208.333%2c285.724%2c195.864C279.901%2c183.396%2c268.255%2c175.791%2c262.432%2c171.989L256.609%2c168.187&#x27;/%3e%3c/g%3e%3cg class=&#x27;edgeLabels&#x27;%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;edgeLabel&#x27;%3e%3cg transform=&#x27;translate(0%2c 0)&#x27; class=&#x27;label&#x27;%3e%3cforeignObject height=&#x27;0&#x27; width=&#x27;0&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; class=&#x27;labelBkg&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;edgeLabel&#x27;%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3c/g%3e%3cg class=&#x27;nodes&#x27;%3e%3cg transform=&#x27;translate(211.91015625%2c 35)&#x27; id=&#x27;flowchart-A-0&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;180.046875&#x27; y=&#x27;-27&#x27; x=&#x27;-90.0234375&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-60.0234375%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;120.046875&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eParse Markdown%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg transform=&#x27;translate(211.91015625%2c 139)&#x27; id=&#x27;flowchart-B-1&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;167.609375&#x27; y=&#x27;-27&#x27; x=&#x27;-83.8046875&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-53.8046875%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;107.609375&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eCollect Chunks%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg transform=&#x27;translate(132.2734375%2c 243)&#x27; id=&#x27;flowchart-C-3&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;248.546875&#x27; y=&#x27;-27&#x27; x=&#x27;-124.2734375&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-94.2734375%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;188.546875&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eReplace with Placeholders%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg transform=&#x27;translate(132.2734375%2c 347)&#x27; id=&#x27;flowchart-D-5&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;184.796875&#x27; y=&#x27;-27&#x27; x=&#x27;-92.3984375&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-62.3984375%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;124.796875&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eTranslate Chunks%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg transform=&#x27;translate(211.91015625%2c 451)&#x27; id=&#x27;flowchart-E-7&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;190.734375&#x27; y=&#x27;-27&#x27; x=&#x27;-95.3671875&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-65.3671875%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;130.734375&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eApply Translations%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg transform=&#x27;translate(277.09375%2c 555)&#x27; id=&#x27;flowchart-J-9&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;157.84375&#x27; y=&#x27;-27&#x27; x=&#x27;-78.921875&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-48.921875%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;97.84375&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eJudge Quality%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3cg transform=&#x27;translate(277.09375%2c 659)&#x27; id=&#x27;flowchart-F-13&#x27; class=&#x27;node default&#x27;%3e%3crect height=&#x27;54&#x27; width=&#x27;164.953125&#x27; y=&#x27;-27&#x27; x=&#x27;-82.4765625&#x27; style=&#x27;&#x27; class=&#x27;basic label-container&#x27;/%3e%3cg transform=&#x27;translate(-52.4765625%2c -12)&#x27; style=&#x27;&#x27; class=&#x27;label&#x27;%3e%3crect/%3e%3cforeignObject height=&#x27;24&#x27; width=&#x27;104.953125&#x27;%3e%3cdiv style=&#x27;display: table-cell%3b white-space: nowrap%3b line-height: 1.5%3b max-width: 200px%3b text-align: center%3b&#x27; xmlns=&#x27;http://www.w3.org/1999/xhtml&#x27;%3e%3cspan class=&#x27;nodeLabel&#x27;%3e%3cp%3eSave to Cache%3c/p%3e%3c/span%3e%3c/div%3e%3c/foreignObject%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e" width="374.7300109863281"></picture>
<div class="sl-heading-wrapper level-h3"><h3 id="outils-ast-pour-markdown">Outils AST pour Markdown</h3><a class="sl-anchor-link" href="#outils-ast-pour-markdown"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Outils AST pour Markdown »</span></a></div>
<p>La communauté web a développé de nombreux outils pour analyser et manipuler des documents markdown.
GenAIScript propose un plugin opinioné, <a href="https://www.npmjs.com/package/@genaiscript/plugin-mdast">@genaiscript/plugin-mdast</a>, qui fournit les fonctionnalités principales sans se soucier de la configuration.</p>
<ul>
<li>charger le plugin</li>
</ul>
<div class="expressive-code"><link rel="stylesheet" href="/genaiscript/_astro/ec.v4551.css"><script type="module" src="/genaiscript/_astro/ec.8zarh.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts" class="wrap" style="--ecMaxLine:56ch"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { mdast } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">@genaiscript/plugin-mdast</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const { </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#C792EA;--1:#8844AE"> } = await </span><span style="--0:#82AAFF;--1:#3B61B0">mdast</span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="import { mdast } from &#x22;@genaiscript/plugin-mdast&#x22;;const { visit, parse, stringify, SKIP } = await mdast();"><div></div></button></div></figure></div>
<ul>
<li>analyser le fichier markdown</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts" class="wrap" style="--ecMaxLine:25ch"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">root</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#D6DEEB;--1:#403F53">(file);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="const root = parse(file);"><div></div></button></div></figure></div>
<ul>
<li>parcourir l’arbre et collecter les blocs</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts" class="wrap" style="--ecMaxLine:46ch"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nodes</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#FFCB8B;--1:#111111">Record</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#FFCB8B;--1:#111111">NodeType</span><span style="--0:#C792EA;--1:#8844AE">> = {}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(root, [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">paragraph</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">], </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(node);</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">node: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53">, hash);</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">nodes[hash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> node </span><span style="--0:#C792EA;--1:#8844AE">as</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">NodeType</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="const nodes: Record<string, NodeType> = {};visit(root, [&#x22;text&#x22;, &#x22;paragraph&#x22;], (node) => {  const hash = hashNode(node);  dbg(&#x60;node: %s -> %s&#x60;, node.type, hash);  nodes[hash] = node as NodeType;});"><div></div></button></div></figure></div>
<ul>
<li>convertir l’arbre à nouveau en markdown</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts" class="wrap" style="--ecMaxLine:33ch"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">markdown</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(root);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="const markdown = stringify(root);"><div></div></button></div></figure></div>
<p>Avec ces opérations primitives, nous pouvons créer un script capable d’analyser, d’extraire les tâches de traduction, de traduire, d’appliquer la traduction puis de convertir de nouveau en markdown.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="traductions-en-une-seule-passe">Traductions en une seule passe</h3><a class="sl-anchor-link" href="#traductions-en-une-seule-passe"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Traductions en une seule passe »</span></a></div>
<p>La méthode consiste à entourer chaque segment traduisible d’un marqueur d’identifiant unique comme <code dir="auto">Continuous Markdown Translations</code>, puis à demander au LLM de traduire chaque segment et à retourner les traductions dans un format analysable.</p>
<p>Voici à quoi ressemble le prompt pour cet article :</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="markdown" class="wrap" style="--ecMaxLine:218ch"><code><div class="ec-line"><div class="code"><span style="--1:#8844AE"><span style="--0:#7FDBCA">&#x3C;</span><span style="--0:#CAECE6">ORIGINAL</span><span style="--0:#7FDBCA">></span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">title: Continuous Markdown Translations</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">description: A walkthrough the script that translates the GenAIScript documentation into multiple languages.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">date: 2025-07-02</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">You may have noticed that the GenAIScript documentation is now available in **French** (try the upper-right language dropdown).</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">The translations are not just a one-time effort; they are **continuously** updated as the documentation evolves, in a GitHub Actions. This means that whenever new content is added or existing content is modified,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">the translations are automatically updated to reflect those changes.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">In this post, we'll go through some of the interesting parts of the script and how it works.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">...</span></div></div><div class="ec-line"><div class="code"><span style="--1:#8844AE"><span style="--0:#7FDBCA">&#x3C;/</span><span style="--0:#CAECE6">ORIGINAL</span><span style="--0:#7FDBCA">></span></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--1:#8844AE"><span style="--0:#7FDBCA">&#x3C;</span><span style="--0:#CAECE6">TRANSLATED</span><span style="--0:#7FDBCA">></span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">title: ┌T000┐Continuous Markdown Translations└T000┘</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">description: ┌D001┐A walkthrough the script that translates the GenAIScript</span></div></div><div class="ec-line" style="--ecIndent:2ch"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">documentation into multiple languages.└D001┘</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">---</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">┌P002┐You may have noticed that the GenAIScript documentation is now available in **French** (try the upper-right language dropdown).└P002┘</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">┌P003┐The translations are not just a one-time effort; they are **continuously** updated as the documentation evolves, in a GitHub Actions. This means that whenever new content is added or existing content is modified,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">the translations are automatically updated to reflect those changes.└P003┘</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">┌P004┐In this post, we'll go through some of the interesting parts of the script and how it works.└P004┘</span></div></div><div class="ec-line"><div class="code"><span style="--1:#8844AE"><span style="--0:#7FDBCA">&#x3C;/</span><span style="--0:#CAECE6">TRANSLATED</span><span style="--0:#7FDBCA">></span></span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="<ORIGINAL>---title: Continuous Markdown Translationsdescription: A walkthrough the script that translates the GenAIScript documentation into multiple languages.date: 2025-07-02...---You may have noticed that the GenAIScript documentation is now available in **French** (try the upper-right language dropdown).The translations are not just a one-time effort; they are **continuously** updated as the documentation evolves, in a GitHub Actions. This means that whenever new content is added or existing content is modified,the translations are automatically updated to reflect those changes.In this post, we&#x27;ll go through some of the interesting parts of the script and how it works....</ORIGINAL><TRANSLATED>---title: ┌T000┐Continuous Markdown Translations└T000┘description: ┌D001┐A walkthrough the script that translates the GenAIScript  documentation into multiple languages.└D001┘...---┌P002┐You may have noticed that the GenAIScript documentation is now available in **French** (try the upper-right language dropdown).└P002┘┌P003┐The translations are not just a one-time effort; they are **continuously** updated as the documentation evolves, in a GitHub Actions. This means that whenever new content is added or existing content is modified,the translations are automatically updated to reflect those changes.└P003┘┌P004┐In this post, we&#x27;ll go through some of the interesting parts of the script and how it works.└P004┘</TRANSLATED>"><div></div></button></div></figure></div>
<p>Le LLM doit traduire le texte entre <code dir="auto">&#x3C;ORIGINAL></code> et <code dir="auto">&#x3C;TRANSLATED></code>, puis renvoyer le texte traduit avec les mêmes balises, chaque segment traduisible ayant un identifiant unique.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="markdown" class="wrap" style="--ecMaxLine:253ch"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```T000</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Traductions Markdown Continues</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```D001</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Un aperçu du script qui traduit la documentation GenAIScript dans plusieurs langues.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```P002</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Vous avez peut-être remarqué que la documentation de GenAIScript est désormais disponible en **français** (essayez le menu déroulant de langue en haut à droite).</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```P003</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Les traductions ne sont pas un effort ponctuel ; elles sont mises à jour **en continu** à mesure que la documentation évolue, grâce à GitHub Actions. Cela signifie que chaque fois que du nouveau contenu est ajouté ou que du contenu existant est modifié,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">les traductions sont automatiquement mises à jour pour refléter ces changements.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```P004</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Dans cet article, nous allons passer en revue certains aspects intéressants du script et son fonctionnement.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```P005</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">Le défi de la traduction de la documentation</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">```</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="&#x60;&#x60;&#x60;T000Traductions Markdown Continues&#x60;&#x60;&#x60;&#x60;&#x60;&#x60;D001Un aperçu du script qui traduit la documentation GenAIScript dans plusieurs langues.&#x60;&#x60;&#x60;&#x60;&#x60;&#x60;P002Vous avez peut-être remarqué que la documentation de GenAIScript est désormais disponible en **français** (essayez le menu déroulant de langue en haut à droite).&#x60;&#x60;&#x60;&#x60;&#x60;&#x60;P003Les traductions ne sont pas un effort ponctuel ; elles sont mises à jour **en continu** à mesure que la documentation évolue, grâce à GitHub Actions. Cela signifie que chaque fois que du nouveau contenu est ajouté ou que du contenu existant est modifié,les traductions sont automatiquement mises à jour pour refléter ces changements.&#x60;&#x60;&#x60;&#x60;&#x60;&#x60;P004Dans cet article, nous allons passer en revue certains aspects intéressants du script et son fonctionnement.&#x60;&#x60;&#x60;&#x60;&#x60;&#x60;P005Le défi de la traduction de la documentation&#x60;&#x60;&#x60;"><div></div></button></div></figure></div>
<p>Les segments sont alors analysés puis injectés de nouveau dans l’AST avant d’être rendus en chaîne. On peut également les enregistrer dans un fichier JSON pour le cache, afin que lors du prochain passage du script, il puisse réutiliser les traductions sans devoir les refaire.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="évaluer-la-qualité-de-la-traduction">Évaluer la qualité de la traduction</h2><a class="sl-anchor-link" href="#évaluer-la-qualité-de-la-traduction"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Évaluer la qualité de la traduction »</span></a></div>
<p>Pour garantir la qualité des traductions, nous appliquons plusieurs stratégies :</p>
<ul>
<li>valider mécaniquement la validité du Markdown obtenu. Certains caractères spéciaux peuvent bloquer l’analyseur.</li>
<li>s’assurer qu’aucune URL externe n’a été modifiée. Le LLM ne doit ni modifier, ni ajouter, ni supprimer d’URL.</li>
<li>lancer un prompt <strong>LLM-as-Judge</strong> qui évalue la qualité de traduction. Cela se fait en demandant au LLM de comparer l’original et la traduction, puis de fournir un score de qualité.</li>
</ul>
<div class="sl-heading-wrapper level-h2"><h2 id="commit-et-push-des-modifications">Commit et push des modifications</h2><a class="sl-anchor-link" href="#commit-et-push-des-modifications"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Commit et push des modifications »</span></a></div>
<p>Une fois toutes les vérifications passées, le script commite les changements et les pousse sur la branche distante… et voilà ! Les traductions sont désormais accessibles dans la documentation.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="explication-détaillée-du-code">Explication détaillée du code</h2><a class="sl-anchor-link" href="#explication-détaillée-du-code"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Explication détaillée du code »</span></a></div>
<p>Ce qui suit est une revue de code générée par l’IA qui couvre tout le script dans le détail. C’est un peu long, mais cela explique tout ce qui est intéressant dans ce script et son fonctionnement.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="imports">Imports</h3><a class="sl-anchor-link" href="#imports"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Imports »</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { hash } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">crypto</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { classify } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">@genaiscript/runtime</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { mdast } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">@genaiscript/plugin-mdast</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdast-util-mdxjs-esm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdast-util-mdx-jsx</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">type</span><span style="--0:#D6DEEB;--1:#403F53"> { Node, Text, Heading, Paragraph, PhrasingContent, Yaml } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdast</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { basename, dirname, join, relative } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">path</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { URL } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">url</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> { xor } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">es-toolkit</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">type</span><span style="--0:#D6DEEB;--1:#403F53"> { MdxJsxFlowElement } </span><span style="--0:#C792EA;--1:#8844AE">from</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdast-util-mdx-jsx</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="import { hash } from &#x22;crypto&#x22;;import { classify } from &#x22;@genaiscript/runtime&#x22;;import { mdast } from &#x22;@genaiscript/plugin-mdast&#x22;;import &#x22;mdast-util-mdxjs-esm&#x22;;import &#x22;mdast-util-mdx-jsx&#x22;;import type { Node, Text, Heading, Paragraph, PhrasingContent, Yaml } from &#x22;mdast&#x22;;import { basename, dirname, join, relative } from &#x22;path&#x22;;import { URL } from &#x22;url&#x22;;import { xor } from &#x22;es-toolkit&#x22;;import type { MdxJsxFlowElement } from &#x22;mdast-util-mdx-jsx&#x22;;"><div></div></button></div></figure></div>
<ul>
<li><code dir="auto">hash</code> est utilisé pour créer des identifiants uniques pour les sections du document.</li>
<li><code dir="auto">classify</code> est importé depuis <a href="https://github.com/microsoft/genaiscript/blob/main/packages/cli/src/runtime.ts">@genaiscript/runtime</a> pour juger la qualité des traductions.</li>
<li><code dir="auto">mdast</code> permet d’analyser et de construire des arbres de syntaxe abstraite Markdown (AST).</li>
<li>Les modules <code dir="auto">"mdast-util-mdxjs-esm"</code> et <code dir="auto">"mdast-util-mdx-jsx"</code> ajoutent la prise en charge des fonctionnalités MDX.</li>
<li>Les types venant de <code dir="auto">"mdast"</code> servent à définir la structure des nœuds Markdown.</li>
<li>Les helpers de chemin et d’URL facilitent la gestion des fichiers et la correction des URLs.</li>
<li><code dir="auto">xor</code> permet de comparer des tableaux pour détecter les différences.</li>
<li><code dir="auto">MdxJsxFlowElement</code> définit les nœuds de bloc MDX JSX.</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="configuration-du-script">Configuration du script</h3><a class="sl-anchor-link" href="#configuration-du-script"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Configuration du script »</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3B61B0">script</span><span style="--0:#D6DEEB;--1:#403F53">({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">accept: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">.md,.mdx</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">files: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">src/rag/markdown.md</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">parameters: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">to: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">type: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">default: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">fr</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">description: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">The iso-code target language for translation.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">force: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">type: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">boolean</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">default: </span><span style="--0:#FF6A83;--1:#A24848">false</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">description: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">Force translation even if the file has already been translated.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">},</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="script({  accept: &#x22;.md,.mdx&#x22;,  files: &#x22;src/rag/markdown.md&#x22;,  parameters: {    to: {      type: &#x22;string&#x22;,      default: &#x22;fr&#x22;,      description: &#x22;The iso-code target language for translation.&#x22;,    },    force: {      type: &#x22;boolean&#x22;,      default: false,      description: &#x22;Force translation even if the file has already been translated.&#x22;,    },  },});"><div></div></button></div></figure></div>
<ul>
<li>Définit les extensions de fichiers et les chemins à traiter (<code dir="auto">.md</code>, <code dir="auto">.mdx</code>).</li>
<li>Définit les paramètres : <code dir="auto">to</code> (langue cible, français par défaut), <code dir="auto">force</code> (retraduit même si déjà traduit).</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="constantes-et-utilitaires">Constantes et utilitaires</h3><a class="sl-anchor-link" href="#constantes-et-utilitaires"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Constantes et utilitaires »</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">HASH_LENGTH</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#F78C6C;--1:#AA0982">20</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">maxPromptPerFile</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#F78C6C;--1:#AA0982">5</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nodeTypes</span><span style="--0:#C792EA;--1:#8844AE"> =</span><span style="--0:#D6DEEB;--1:#403F53"> [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">paragraph</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">heading</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">yaml</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">];</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">starlightDir</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">docs/src/content/docs</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">starlightBase</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">genaiscript</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">startlightBaseRx</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#7FDBCA;--1:#096E72">new</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#82AAFF;--1:#3B61B0">RegExp</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">^/</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">starlightBase</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">/</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">MARKER_START</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">┌</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">MARKER_END</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">└</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">type</span><span style="--0:#D6DEEB;--1:#403F53"> NodeType </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">Text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">Paragraph</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">Heading</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">Yaml</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">langs</span><span style="--0:#C792EA;--1:#8844AE"> = {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">fr: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">French</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="const HASH_LENGTH = 20;const maxPromptPerFile = 5;const nodeTypes = [&#x22;text&#x22;, &#x22;paragraph&#x22;, &#x22;heading&#x22;, &#x22;yaml&#x22;];const starlightDir = &#x22;docs/src/content/docs&#x22;;const starlightBase = &#x22;genaiscript&#x22;;const startlightBaseRx = new RegExp(&#x60;^/${starlightBase}/&#x60;);const MARKER_START = &#x22;┌&#x22;;const MARKER_END = &#x22;└&#x22;;type NodeType = Text | Paragraph | Heading | Yaml;const langs = {  fr: &#x22;French&#x22;,};"><div></div></button></div></figure></div>
<ul>
<li>Définit la longueur des hash, la limite d’essais de traduction, les types de nœuds Markdown à traduire, les chemins, et les codes de langues disponibles.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">isUri</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">str</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#FFCB8B;--1:#111111">URL</span><span style="--0:#C792EA;--1:#8844AE"> => {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">try {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">    </span></span><span style="--0:#C792EA;--1:#8844AE">return </span><span style="--0:#7FDBCA;--1:#096E72">new</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#82AAFF;--1:#3B61B0">URL</span><span style="--0:#D6DEEB;--1:#403F53">(str)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">} catch {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">    </span></span><span style="--0:#C792EA;--1:#8844AE">return </span><span style="--0:#82AAFF;--1:#3B61B0">undefined</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="const isUri = (str: string): URL => {  try {    return new URL(str);  } catch {    return undefined;  }};"><div></div></button></div></figure></div>
<ul>
<li>Vérifie si une chaîne est une URL valide.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hasMarker</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">str</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">boolean</span><span style="--0:#C792EA;--1:#8844AE"> => {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">return </span><span style="--0:#D6DEEB;--1:#403F53">str</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">includes</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3B61B0">MARKER_START</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE"> || </span><span style="--0:#D6DEEB;--1:#403F53">str</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">includes</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3B61B0">MARKER_END</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="const hasMarker = (str: string): boolean => {  return str.includes(MARKER_START) || str.includes(MARKER_END);};"><div></div></button></div></figure></div>
<ul>
<li>Détecte si une chaîne contient des marqueurs de traduction.</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="logique-principale-du-script">Logique principale du script</h3><a class="sl-anchor-link" href="#logique-principale-du-script"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « Logique principale du script »</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">export</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">async</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">function</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">main</span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="export default async function main() {"><div></div></button></div></figure></div>
<ul>
<li>C’est le point d’entrée du script.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const { </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">output</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">vars</span><span style="--0:#C792EA;--1:#8844AE"> } = </span><span style="--0:#D6DEEB;--1:#403F53">env;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">host</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">logger</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">script:md</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">dbgt</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">host</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">logger</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">script:tree</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">dbge</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">host</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">logger</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">script:text</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">dbgm</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">host</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">logger</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">script:mdx</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const { </span><span style="--0:#82AAFF;--1:#3B61B0">force</span><span style="--0:#C792EA;--1:#8844AE"> } = </span><span style="--0:#D6DEEB;--1:#403F53">vars</span><span style="--0:#C792EA;--1:#8844AE"> as {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">force</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">boolean</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="  const { dbg, output, vars } = env;  const dbgc = host.logger(&#x60;script:md&#x60;);  const dbgt = host.logger(&#x60;script:tree&#x60;);  const dbge = host.logger(&#x60;script:text&#x60;);  const dbgm = host.logger(&#x60;script:mdx&#x60;);  const { force } = vars as {    to: string;    force: boolean;  };"><div></div></button></div></figure></div>
<ul>
<li>Prépare le logging, le debug, et récupère les paramètres utilisateur.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tos</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">vars</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">to</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">split</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">,</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">map</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">s</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> s</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">trim</span><span style="--0:#D6DEEB;--1:#403F53">())</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">filter</span><span style="--0:#D6DEEB;--1:#403F53">(Boolean);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">tos: %o</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, tos);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="  const tos = vars.to    .split(&#x22;,&#x22;)    .map((s) => s.trim())    .filter(Boolean);  dbg(&#x60;tos: %o&#x60;, tos);"><div></div></button></div></figure></div>
<ul>
<li>Permet la traduction vers plusieurs langues en une passe.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">ignorer</span><span style="--0:#C792EA;--1:#8844AE"> = await </span><span style="--0:#D6DEEB;--1:#403F53">parsers</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">ignore</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">.mdtranslatorignore</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">files</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">env</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">files</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">filter</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">f</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">ignorer</span><span style="--0:#D6DEEB;--1:#403F53">([f])</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">filter</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--1:#403F53"><span style="--0:#D6DEEB">{ </span><span style="--0:#D7DBE0">filename</span><span style="--0:#D6DEEB"> }</span></span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">!</span><span style="--0:#D6DEEB;--1:#403F53">tos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">some</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">to</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> filename</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">includes</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">/</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toLowerCase</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">/</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">)));</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">!</span><span style="--0:#D6DEEB;--1:#403F53">files</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#D6DEEB;--1:#403F53">) </span><span style="--0:#82AAFF;--1:#3B61B0">cancel</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">No files selected.</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">files: %O</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">files</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">map</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">f</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> f</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">filename</span><span style="--0:#D6DEEB;--1:#403F53">),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="  const ignorer = await parsers.ignore(&#x22;.mdtranslatorignore&#x22;);  const files = env.files    .filter((f) => ignorer([f]).length)    .filter(({ filename }) => !tos.some((to) => filename.includes(&#x60;/${to.toLowerCase()}/&#x60;)));  if (!files.length) cancel(&#x22;No files selected.&#x22;);  dbg(    &#x60;files: %O&#x60;,    files.map((f) => f.filename),  );"><div></div></button></div></figure></div>
<ul>
<li>Ignore les fichiers listés dans <code dir="auto">.mdtranslatorignore</code> et exclut ceux déjà traduits.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const { </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#C792EA;--1:#8844AE"> } = await </span><span style="--0:#82AAFF;--1:#3B61B0">mdast</span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="  const { visit, parse, stringify, SKIP } = await mdast();"><div></div></button></div></figure></div>
<ul>
<li>Charge les fonctions d’analyse et de parcours Markdown.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#FFCB8B;--1:#111111">Node</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8844AE"> => {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">    </span></span><span style="--0:#C792EA;--1:#8844AE">if </span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE"> === </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">object</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">structuredClone</span><span style="--0:#D6DEEB;--1:#403F53">(node)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8844AE"> => </span><span style="--0:#7FDBCA;--1:#096E72">delete</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">position</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">    </span></span><span style="--0:#C792EA;--1:#8844AE">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">    </span></span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">chunkHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hash</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">sha-256</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">JSON</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(node))</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">    </span></span><span style="--0:#C792EA;--1:#8844AE">return </span><span style="--0:#D6DEEB;--1:#403F53">chunkHash</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">slice</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">HASH_LENGTH</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toUpperCase</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">  </span></span><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="  const hashNode = (node: Node | string) => {    if (typeof node === &#x22;object&#x22;) {      node = structuredClone(node);      visit(node, (node) => delete node.position);    }    const chunkHash = hash(&#x22;sha-256&#x22;, JSON.stringify(node));    return chunkHash.slice(0, HASH_LENGTH).toUpperCase();  };"><div></div></button></div></figure></div>
<ul>
<li>Crée un hash des nœuds (sans position) pour générer des identifiants uniques à chaque segment de texte.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C792EA;--1:#8844AE">for</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">to</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#7FDBCA;--1:#096E72">of</span><span style="--0:#D6DEEB;--1:#403F53"> tos) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">lang</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">langs[to];</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">!</span><span style="--0:#D6DEEB;--1:#403F53">lang) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">res</span><span style="--0:#C792EA;--1:#8844AE"> = await </span><span style="--0:#82AAFF;--1:#3B61B0">prompt</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Respond human friendly name of language: </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">options</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8844AE">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">        </span></span><span style="--0:#C792EA;--1:#8844AE">cache: </span><span style="--0:#FF6A83;--1:#A24848">true</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">        </span></span><span style="--0:#C792EA;--1:#8844AE">systemSafety: </span><span style="--0:#FF6A83;--1:#A24848">false</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">        </span></span><span style="--0:#C792EA;--1:#8844AE">responseType: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">        </span></span><span style="--0:#C792EA;--1:#8844AE">throwOnError: </span><span style="--0:#FF6A83;--1:#A24848">true</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">      </span></span><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">lang </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> res</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="  for (const to of tos) {    let lang = langs[to];    if (!lang) {      const res = await prompt&#x60;Respond human friendly name of language: ${to}&#x60;.options({        cache: true,        systemSafety: false,        responseType: &#x22;text&#x22;,        throwOnError: true,      });      lang = res.text;    }"><div></div></button></div></figure></div>
<ul>
<li>Recherche le nom de la langue ou le demande à l’IA si non référencée.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">heading</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Translating Markdown files to </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">lang</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> (</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">)</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translationCacheFilename</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">docs/translations/</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toLowerCase</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">.json</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">cache: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, translationCacheFilename);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">itemValue</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">cache</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, translationCacheFilename);</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#919F9F;--1:#5D6376">// hash -> text translation</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translationCache</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#FFCB8B;--1:#111111">Record</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">> = </span><span style="--0:#D6DEEB;--1:#403F53">force</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">?</span><span style="--0:#D6DEEB;--1:#403F53"> {}</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">:</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">await</span><span style="--0:#D6DEEB;--1:#403F53"> workspace</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">readJSON</span><span style="--0:#D6DEEB;--1:#403F53">(translationCacheFilename)) </span><span style="--0:#C792EA;--1:#8844AE">||</span><span style="--0:#D6DEEB;--1:#403F53"> {};</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">for</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">const [</span><span style="--0:#82AAFF;--1:#3B61B0">k</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">v</span><span style="--0:#C792EA;--1:#8844AE">] </span><span style="--0:#7FDBCA;--1:#096E72">of</span><span style="--0:#D6DEEB;--1:#403F53"> Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">entries</span><span style="--0:#D6DEEB;--1:#403F53">(translationCache)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#82AAFF;--1:#3B61B0">hasMarker</span><span style="--0:#D6DEEB;--1:#403F53">(v)) </span><span style="--0:#7FDBCA;--1:#096E72">delete</span><span style="--0:#D6DEEB;--1:#403F53"> translationCache[k];</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translation cache: %O</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, translationCache);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="    output.heading(2, &#x60;Translating Markdown files to ${lang} (${to})&#x60;);    const translationCacheFilename = &#x60;docs/translations/${to.toLowerCase()}.json&#x60;;    dbg(&#x60;cache: %s&#x60;, translationCacheFilename);    output.itemValue(&#x22;cache&#x22;, translationCacheFilename);    // hash -> text translation    const translationCache: Record<string, string> = force      ? {}      : (await workspace.readJSON(translationCacheFilename)) || {};    for (const [k, v] of Object.entries(translationCache)) {      if (hasMarker(v)) delete translationCache[k];    }    dbgc(&#x60;translation cache: %O&#x60;, translationCache);"><div></div></button></div></figure></div>
<ul>
<li>Charge le cache des traductions précédentes pour éviter de retraduire. Supprime tout segment laissé en attente avec un marqueur.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">for</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">file</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#7FDBCA;--1:#096E72">of</span><span style="--0:#D6DEEB;--1:#403F53"> files) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">const { </span><span style="--0:#82AAFF;--1:#3B61B0">filename</span><span style="--0:#C792EA;--1:#8844AE"> } = </span><span style="--0:#D6DEEB;--1:#403F53">file;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">heading</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">filename</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">try</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">starlight</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">filename</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">startsWith</span><span style="--0:#D6DEEB;--1:#403F53">(starlightDir);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translationFn</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">starlight</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">?</span><span style="--0:#D6DEEB;--1:#403F53"> filename</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(starlightDir, </span><span style="--0:#82AAFF;--1:#3B61B0">join</span><span style="--0:#D6DEEB;--1:#403F53">(starlightDir, to</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toLowerCase</span><span style="--0:#D6DEEB;--1:#403F53">()))</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">:</span><span style="--0:#D6DEEB;--1:#403F53"> path</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">changeext</span><span style="--0:#D6DEEB;--1:#403F53">(filename, </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">.</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toLowerCase</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">.md</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translation %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, translationFn);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="    for (const file of files) {      const { filename } = file;      output.heading(3, &#x60;${filename}&#x60;);      try {        const starlight = filename.startsWith(starlightDir);        const translationFn = starlight          ? filename.replace(starlightDir, join(starlightDir, to.toLowerCase()))          : path.changeext(filename, &#x60;.${to.toLowerCase()}.md&#x60;);        dbg(&#x60;translation %s&#x60;, translationFn);"><div></div></button></div></figure></div>
<ul>
<li>Détermine le chemin du fichier de sortie pour la traduction.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">fn</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D7DBE0;--1:#403F53">trailingSlash</span><span style="--0:#7FDBCA;--1:#096E72">?:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#C5E478;--1:#3B61B0">boolean</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8844AE"> => {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">          </span></span><span style="--0:#C792EA;--1:#8844AE">if </span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#D6DEEB;--1:#403F53">fn</span><span style="--0:#C792EA;--1:#8844AE"> === </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE"> &#x26;&#x26;</span><span style="--0:#5CA7E4;--1:#3A688F"> </span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#C792EA;--1:#8844AE">^</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">test</span><span style="--0:#D6DEEB;--1:#403F53">(fn)</span><span style="--0:#C792EA;--1:#8844AE"> &#x26;&#x26; </span><span style="--0:#D6DEEB;--1:#403F53">starlight)</span><span style="--0:#C792EA;--1:#8844AE"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">originalDir</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">dirname</span><span style="--0:#D6DEEB;--1:#403F53">(filename)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translationDir</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">dirname</span><span style="--0:#D6DEEB;--1:#403F53">(translationFn)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">relativeToOriginal</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">relative</span><span style="--0:#D6DEEB;--1:#403F53">(translationDir</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">originalDir)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">r</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">join</span><span style="--0:#D6DEEB;--1:#403F53">(relativeToOriginal</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">fn)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">if </span><span style="--0:#D6DEEB;--1:#403F53">(trailingSlash</span><span style="--0:#C792EA;--1:#8844AE"> &#x26;&#x26; !</span><span style="--0:#D6DEEB;--1:#403F53">r</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">endsWith</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">))</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#D6DEEB;--1:#403F53">r</span><span style="--0:#C792EA;--1:#8844AE"> += </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">/</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">patching %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">fn</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">r)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">return </span><span style="--0:#D6DEEB;--1:#403F53">r</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">          </span></span><span style="--0:#C792EA;--1:#8844AE">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">          </span></span><span style="--0:#C792EA;--1:#8844AE">return </span><span style="--0:#D6DEEB;--1:#403F53">fn</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">        </span></span><span style="--0:#C792EA;--1:#8844AE">}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        const patchFn = (fn: string, trailingSlash?: boolean) => {          if (typeof fn === &#x22;string&#x22; &#x26;&#x26; /^\./.test(fn) &#x26;&#x26; starlight) {            const originalDir = dirname(filename);            const translationDir = dirname(translationFn);            const relativeToOriginal = relative(translationDir, originalDir);            let r = join(relativeToOriginal, fn);            if (trailingSlash &#x26;&#x26; !r.endsWith(&#x22;/&#x22;)) r += &#x22;/&#x22;;            dbg(&#x60;patching %s -> %s&#x60;, fn, r);            return r;          }          return fn;        };"><div></div></button></div></figure></div>
<ul>
<li>Corrige les chemins d’images et d’import locaux pour garantir la fonctionnalité dans les fichiers traduits.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">content</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">file</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">content</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">md: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, content);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// normalize content</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">normalizing content</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">content </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#D6DEEB;--1:#403F53">(content));</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        let content = file.content;        dbgc(&#x60;md: %s&#x60;, content);        // normalize content        dbgc(&#x60;normalizing content&#x60;);        content = stringify(parse(content));"><div></div></button></div></figure></div>
<ul>
<li>Lit le contenu des fichiers et normalise la mise en forme avant tout traitement.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// parse to tree</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">parsing %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, filename);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">root</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#D6DEEB;--1:#403F53">(content);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgt</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">original %O</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, root</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">children</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// collect original nodes nodes</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nodes</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#FFCB8B;--1:#111111">Record</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#FFCB8B;--1:#111111">NodeType</span><span style="--0:#C792EA;--1:#8844AE">> = {}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(root, nodeTypes, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(node);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">node: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53">, hash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">nodes[hash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> node </span><span style="--0:#C792EA;--1:#8844AE">as</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">NodeType</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">nodes: %d</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(nodes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHashes</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#FFCB8B;--1:#111111">Record</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">> = {}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#7FDBCA;--1:#096E72">new</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#82AAFF;--1:#3B61B0">Set</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">></span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // parse to tree        dbgc(&#x60;parsing %s&#x60;, filename);        const root = parse(content);        dbgt(&#x60;original %O&#x60;, root.children);        // collect original nodes nodes        const nodes: Record<string, NodeType> = {};        visit(root, nodeTypes, (node) => {          const hash = hashNode(node);          dbg(&#x60;node: %s -> %s&#x60;, node.type, hash);          nodes[hash] = node as NodeType;        });        dbg(&#x60;nodes: %d&#x60;, Object.keys(nodes).length);        const llmHashes: Record<string, string> = {};        const llmHashTodos = new Set<string>();"><div></div></button></div></figure></div>
<ul>
<li>Parse le contenu en AST Markdown et collecte les nœuds uniques à traduire.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// apply translations and mark untranslated nodes with id</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">translated</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">structuredClone</span><span style="--0:#D6DEEB;--1:#403F53">(root);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, nodeTypes, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(node);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translation</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (translation) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translated: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">assign</span><span style="--0:#D6DEEB;--1:#403F53">(node, translation);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#919F9F;--1:#5D6376">// mark untranslated nodes with a unique identifier</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">!</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#82AAFF;--1:#3B61B0">\s</span><span style="--0:#7FDBCA;--1:#096E72">*</span><span style="--0:#82AAFF;--1:#3B61B0">[.,:;&#x3C;></span><span style="--0:#F78C6C;--1:#AA0982">\]\[</span><span style="--0:#82AAFF;--1:#3B61B0">{}</span><span style="--0:#F78C6C;--1:#AA0982">\(\)</span><span style="--0:#82AAFF;--1:#3B61B0">…]</span><span style="--0:#7FDBCA;--1:#096E72">+</span><span style="--0:#82AAFF;--1:#3B61B0">\s</span><span style="--0:#7FDBCA;--1:#096E72">*</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">test</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">) </span><span style="--0:#C792EA;--1:#8844AE">&#x26;&#x26;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">!</span><span style="--0:#82AAFF;--1:#3B61B0">isUri</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">text node: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#919F9F;--1:#5D6376">// compress long hash into LLM friendly short hash</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">T</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">paragraph</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">||</span><span style="--0:#D6DEEB;--1:#403F53"> node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">heading</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">paragraph/heading node: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">P</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">children</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">unshift</span><span style="--0:#D6DEEB;--1:#403F53">({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">type: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">value: </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">as</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#FFCB8B;--1:#111111">Text</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">children</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">push</span><span style="--0:#D6DEEB;--1:#403F53">({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">type: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">value: </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">; </span><span style="--0:#919F9F;--1:#5D6376">// don't process children of paragraphs</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">yaml</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml node: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">data</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">parsers</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">YAML</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (data) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (starlight) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (Array</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">isArray</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">actions</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">actions</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">action</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml hero.action: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash, tr);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">!</span><span style="--0:#D6DEEB;--1:#403F53">tr) action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">T</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                          </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                          </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                          </span></span><span style="--0:#D6DEEB;--1:#403F53">action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (data</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml cover image: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">T</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">T</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">D</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">YAML</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(data);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">untranslated node type: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // apply translations and mark untranslated nodes with id        let translated = structuredClone(root);        visit(translated, nodeTypes, (node) => {          const nhash = hashNode(node);          const translation = translationCache[nhash];          if (translation) {            dbg(&#x60;translated: %s&#x60;, nhash);            Object.assign(node, translation);          } else {            // mark untranslated nodes with a unique identifier            if (node.type === &#x22;text&#x22;) {              if (!/\s*[.,:;<>\]\[{}\(\)…]+\s*/.test(node.value) &#x26;&#x26; !isUri(node.value)) {                dbg(&#x60;text node: %s&#x60;, nhash);                // compress long hash into LLM friendly short hash                const llmHash = &#x60;T${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;                llmHashes[llmHash] = nhash;                llmHashTodos.add(llmHash);                node.value = &#x60;┌${llmHash}┐${node.value}└${llmHash}┘&#x60;;              }            } else if (node.type === &#x22;paragraph&#x22; || node.type === &#x22;heading&#x22;) {              dbg(&#x60;paragraph/heading node: %s&#x60;, nhash);              const llmHash = &#x60;P${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;              llmHashes[llmHash] = nhash;              llmHashTodos.add(llmHash);              node.children.unshift({                type: &#x22;text&#x22;,                value: &#x60;┌${llmHash}┐&#x60;,              } as Text);              node.children.push({                type: &#x22;text&#x22;,                value: &#x60;└${llmHash}┘&#x60;,              });              return SKIP; // don&#x27;t process children of paragraphs            } else if (node.type === &#x22;yaml&#x22;) {              dbg(&#x60;yaml node: %s&#x60;, nhash);              const data = parsers.YAML(node.value);              if (data) {                if (starlight) {                  if (Array.isArray(data?.hero?.actions)) {                    data.hero.actions.forEach((action) => {                      if (typeof action.text === &#x22;string&#x22;) {                        const nhash = hashNode(action.text);                        const tr = translationCache[nhash];                        dbg(&#x60;yaml hero.action: %s -> %s&#x60;, nhash, tr);                        if (!tr) action.text = tr;                        else {                          const llmHash = &#x60;T${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;                          llmHashes[llmHash] = nhash;                          llmHashTodos.add(llmHash);                          action.text = &#x60;┌${llmHash}┐${action.text}└${llmHash}┘&#x60;;                        }                      }                    });                  }                  if (data?.cover?.image) {                    data.cover.image = patchFn(data.cover.image);                    dbg(&#x60;yaml cover image: %s&#x60;, data.cover.image);                  }                }                if (typeof data.excerpt === &#x22;string&#x22;) {                  const nhash = hashNode(data.excerpt);                  const tr = translationCache[nhash];                  if (tr) data.excerpt = tr;                  else {                    const llmHash = &#x60;T${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;                    llmHashes[llmHash] = nhash;                    llmHashTodos.add(llmHash);                    data.excerpt = &#x60;┌${llmHash}┐${data.excerpt}└${llmHash}┘&#x60;;                  }                }                if (typeof data.title === &#x22;string&#x22;) {                  const nhash = hashNode(data.title);                  const tr = translationCache[nhash];                  if (tr) data.title = tr;                  else {                    const llmHash = &#x60;T${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;                    llmHashes[llmHash] = nhash;                    llmHashTodos.add(llmHash);                    data.title = &#x60;┌${llmHash}┐${data.title}└${llmHash}┘&#x60;;                  }                }                if (typeof data.description === &#x22;string&#x22;) {                  const nhash = hashNode(data.description);                  const tr = translationCache[nhash];                  if (tr) data.title = tr;                  else {                    const llmHash = &#x60;D${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;                    llmHashes[llmHash] = nhash;                    llmHashTodos.add(llmHash);                    data.description = &#x60;┌${llmHash}┐${data.description}└${llmHash}┘&#x60;;                  }                }                node.value = YAML.stringify(data);                return SKIP;              }            } else {              dbg(&#x60;untranslated node type: %s&#x60;, node.type);            }          }        });"><div></div></button></div></figure></div>
<ul>
<li>Pour chaque nœud, applique la traduction du cache ou marque le segment avec un identifiant unique (ex : <code dir="auto">...</code>) pour la traduction IA.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// patch images and esm imports</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdxJsxFlowElement</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">], </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">flow</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE"> as </span><span style="--0:#FFCB8B;--1:#111111">MdxJsxFlowElement</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">for</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">attribute</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#7FDBCA;--1:#096E72">of</span><span style="--0:#D6DEEB;--1:#403F53"> flow</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">attributes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">||</span><span style="--0:#D6DEEB;--1:#403F53"> []) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdxJsxAttribute</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">&#x26;&#x26;</span><span style="--0:#D6DEEB;--1:#403F53"> attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">name</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">title</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#919F9F;--1:#5D6376">// collect title attributes</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbgm</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">attribute title: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">title</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(title);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) title </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">T</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">Object</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">keys</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashes)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toString</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">padStart</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">3</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">0</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> nhash;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">title </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">┌</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┐</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">title</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">└</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHash</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">┘</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> title;</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // patch images and esm imports        visit(translated, [&#x22;mdxJsxFlowElement&#x22;], (node) => {          const flow = node as MdxJsxFlowElement;          for (const attribute of flow.attributes || []) {            if (attribute.type === &#x22;mdxJsxAttribute&#x22; &#x26;&#x26; attribute.name === &#x22;title&#x22;) {              // collect title attributes              dbgm(&#x60;attribute title: %s&#x60;, attribute.value);              let title = attribute.value;              const nhash = hashNode(title);              const tr = translationCache[nhash];              if (tr) title = tr;              else {                const llmHash = &#x60;T${Object.keys(llmHashes).length.toString().padStart(3, &#x22;0&#x22;)}&#x60;;                llmHashes[llmHash] = nhash;                llmHashTodos.add(llmHash);                title = &#x60;┌${llmHash}┐${title}└${llmHash}┘&#x60;;              }              attribute.value = title;              return SKIP;            }          }        });"><div></div></button></div></figure></div>
<ul>
<li>Assure la prise en compte de l’attribut <code dir="auto">title</code> des composants MDX JSX pour la traduction.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgt</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translated %O</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, translated</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">children</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">attempts</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">lastLLmHashTodos</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">size</span><span style="--0:#C792EA;--1:#8844AE"> + </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">while</span><span style="--0:#D6DEEB;--1:#403F53"> (</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">size</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">&#x26;&#x26;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">size</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> lastLLmHashTodos </span><span style="--0:#C792EA;--1:#8844AE">&#x26;&#x26;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">attempts </span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#D6DEEB;--1:#403F53"> maxPromptPerFile</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">attempts</span><span style="--0:#C792EA;--1:#8844AE">++</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">itemValue</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">missing translations</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">size</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">dbge</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">todos: %o</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, Array</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">from</span><span style="--0:#D6DEEB;--1:#403F53">(llmHashTodos));</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">contentMix</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(translated);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translatable content: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, contentMix);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        dbgt(&#x60;translated %O&#x60;, translated.children);        let attempts = 0;        let lastLLmHashTodos = llmHashTodos.size + 1;        while (          llmHashTodos.size &#x26;&#x26;          llmHashTodos.size < lastLLmHashTodos &#x26;&#x26;          attempts < maxPromptPerFile        ) {          attempts++;          output.itemValue(&#x60;missing translations&#x60;, llmHashTodos.size);          dbge(&#x60;todos: %o&#x60;, Array.from(llmHashTodos));          const contentMix = stringify(translated);          dbgc(&#x60;translatable content: %s&#x60;, contentMix);"><div></div></button></div></figure></div>
<ul>
<li>Suit les tentatives de traduction et les segments manquants afin d’éviter les boucles infinies.</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="prompt-de-traduction">prompt de traduction</h4><a class="sl-anchor-link" href="#prompt-de-traduction"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section intitulée « prompt de traduction »</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const { </span><span style="--0:#82AAFF;--1:#3B61B0">fences</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#82AAFF;--1:#3B61B0">error</span><span style="--0:#C792EA;--1:#8844AE"> } = await </span><span style="--0:#82AAFF;--1:#3B61B0">runPrompt</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">async </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">ctx</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8844AE"> => {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">originalRef</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">ctx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">def</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">ORIGINAL</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">file</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">content</span><span style="--0:#C792EA;--1:#8844AE">, { lineNumbers: </span><span style="--0:#FF6A83;--1:#A24848">false</span><span style="--0:#C792EA;--1:#8844AE"> }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translatedRef</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">ctx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">def</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">TRANSLATED</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">contentMix</span><span style="--0:#C792EA;--1:#8844AE">, { lineNumbers: </span><span style="--0:#FF6A83;--1:#A24848">false</span><span style="--0:#C792EA;--1:#8844AE"> }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#D6DEEB;--1:#403F53">ctx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">$</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">You are an expert at translating technical documentation into </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">lang</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> (</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">).</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">## Task</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">Your task is to translate a Markdown (GFM) document to </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">lang</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> (</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">) while preserving the structure and formatting of the original document.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">You will receive the original document as a variable named </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">originalRef</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> and the currently translated document as a variable named </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">translatedRef</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">Each Markdown AST node in the translated document that has not been translated yet will be enclosed with a unique identifier in the form</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">of </span><span style="--0:#F78C6C;--1:#AA0982">\`</span><span style="--0:#ECC48D;--1:#3B61B0">┌node_identifier┐</span><span style="--0:#F78C6C;--1:#AA0982">\`</span><span style="--0:#ECC48D;--1:#3B61B0"> at the start and </span><span style="--0:#F78C6C;--1:#AA0982">\`</span><span style="--0:#ECC48D;--1:#3B61B0">└node_identifier┘</span><span style="--0:#F78C6C;--1:#AA0982">\`</span><span style="--0:#ECC48D;--1:#3B61B0"> at the end of the node.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">You should translate the content of each these nodes individually.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">Example:</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span><span style="--0:#ECC48D;--1:#3B61B0">markdown</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">┌T001┐</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">This is the content to be translated.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">└T001┘</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">This is some other content that does not need translation.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">┌T002┐</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">This is another piece of content to be translated.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">└T002┘</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">## Output format</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">Respond using code regions where the language string is the HASH value</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">For example:</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span><span style="--0:#ECC48D;--1:#3B61B0">T001</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">translated content of text enclosed in T001 here (only T001 content!)</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span><span style="--0:#ECC48D;--1:#3B61B0">T002</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">translated content of text enclosed in T002 here (only T002 content!)</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span><span style="--0:#ECC48D;--1:#3B61B0">T003</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">translated content of text enclosed in T003 here (only T003 content!)</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F78C6C;--1:#AA0982">\`\`\`</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">## Instructions</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Be extremely careful about the HASH names. They are unique identifiers for each node and should not be changed.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Always use code regions to respond with the translated content.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Do not translate the text outside of the HASH tags.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Do not change the structure of the document.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- As much as possible, maintain the original formatting and structure of the document.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Do not translate inline code blocks, code blocks, or any other code-related content.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Use ' instead of ’</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Always make sure that the URLs are not modified by the translation.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- Translate each node individually, preserving the original meaning and context.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">      </span></span><span style="--0:#ECC48D;--1:#3B61B0">- If you are unsure about the translation, skip the translation.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">role</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">system</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">responseType: </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">systemSafety: </span><span style="--0:#FF6A83;--1:#A24848">false</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">system:</span><span style="--0:#D6DEEB;--1:#403F53"> []</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">cache: </span><span style="--0:#FF6A83;--1:#A24848">true</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">label: </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translating </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">filename</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> (</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">size</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> nodes)</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="          const { fences, error } = await runPrompt(            async (ctx) => {              const originalRef = ctx.def(&#x22;ORIGINAL&#x22;, file.content, { lineNumbers: false });              const translatedRef = ctx.def(&#x22;TRANSLATED&#x22;, contentMix, { lineNumbers: false });              ctx.$&#x60;You are an expert at translating technical documentation into ${lang} (${to}).      ## Task      Your task is to translate a Markdown (GFM) document to ${lang} (${to}) while preserving the structure and formatting of the original document.      You will receive the original document as a variable named ${originalRef} and the currently translated document as a variable named ${translatedRef}.      Each Markdown AST node in the translated document that has not been translated yet will be enclosed with a unique identifier in the form      of \&#x60;┌node_identifier┐\&#x60; at the start and \&#x60;└node_identifier┘\&#x60; at the end of the node.      You should translate the content of each these nodes individually.      Example:      \&#x60;\&#x60;\&#x60;markdown      ┌T001┐      This is the content to be translated.      └T001┘      This is some other content that does not need translation.      ┌T002┐      This is another piece of content to be translated.      └T002┘      \&#x60;\&#x60;\&#x60;      ## Output format      Respond using code regions where the language string is the HASH value      For example:      \&#x60;\&#x60;\&#x60;T001      translated content of text enclosed in T001 here (only T001 content!)      \&#x60;\&#x60;\&#x60;      \&#x60;\&#x60;\&#x60;T002      translated content of text enclosed in T002 here (only T002 content!)      \&#x60;\&#x60;\&#x60;      \&#x60;\&#x60;\&#x60;T003      translated content of text enclosed in T003 here (only T003 content!)      \&#x60;\&#x60;\&#x60;      ...      ## Instructions      - Be extremely careful about the HASH names. They are unique identifiers for each node and should not be changed.      - Always use code regions to respond with the translated content.      - Do not translate the text outside of the HASH tags.      - Do not change the structure of the document.      - As much as possible, maintain the original formatting and structure of the document.      - Do not translate inline code blocks, code blocks, or any other code-related content.      - Use &#x27; instead of ’      - Always make sure that the URLs are not modified by the translation.      - Translate each node individually, preserving the original meaning and context.      - If you are unsure about the translation, skip the translation.      &#x60;.role(&#x22;system&#x22;);            },            {              responseType: &#x22;text&#x22;,              systemSafety: false,              system: [],              cache: true,              label: &#x60;translating ${filename} (${llmHashTodos.size} nodes)&#x60;,            },          );"><div></div></button></div></figure></div>
<ul>
<li>Demande à l’IA de ne traduire que l’intérieur des balises spéciales et de répondre dans des blocs de code où la langue est le hash concerné.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (error) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Error translating </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">filename</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">: </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">error</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">message</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">break</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#919F9F;--1:#5D6376">// collect translations</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">for</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">fence</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#7FDBCA;--1:#096E72">of</span><span style="--0:#D6DEEB;--1:#403F53"> fences) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">llmHash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">fence</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">language</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">has</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">delete</span><span style="--0:#D6DEEB;--1:#403F53">(llmHash);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">llmHashes[llmHash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translation: %s - %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, llmHash, hash);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">chunkTranslated</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">fence</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">content</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#82AAFF;--1:#3B61B0">\r</span><span style="--0:#7FDBCA;--1:#096E72">?</span><span style="--0:#82AAFF;--1:#3B61B0">\n</span><span style="--0:#C792EA;--1:#8844AE">$</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D9F5DD;--1:#111111">""</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">trim</span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">node</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">nodes[hash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">original node: %O</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, node);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">&#x26;&#x26;</span><span style="--0:#5CA7E4;--1:#3A688F"> </span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#82AAFF;--1:#3B61B0">\s</span><span style="--0:#C792EA;--1:#8844AE">$</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">test</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">patch trailing space for %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, hash);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">chunkTranslated </span><span style="--0:#C792EA;--1:#8844AE">+=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">chunkTranslated </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> chunkTranslated</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#5CA7E4;--1:#3A688F">┌</span><span style="--0:#82AAFF;--1:#3B61B0">[A-Z]\d</span><span style="--0:#7FDBCA;--1:#096E72">{3,5}</span><span style="--0:#5CA7E4;--1:#3A688F">┐</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#5CA7E4;--1:#3A688F">g</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">""</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#5CA7E4;--1:#3A688F">└</span><span style="--0:#82AAFF;--1:#3B61B0">[A-Z]\d</span><span style="--0:#7FDBCA;--1:#096E72">{3,5}</span><span style="--0:#5CA7E4;--1:#3A688F">┘</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#5CA7E4;--1:#3A688F">g</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">""</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">content: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, chunkTranslated);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">translationCache[hash] </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> chunkTranslated;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">lastLLmHashTodos </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> llmHashTodos</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">size</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="          if (error) {            output.error(&#x60;Error translating ${filename}: ${error.message}&#x60;);            break;          }          // collect translations          for (const fence of fences) {            const llmHash = fence.language;            if (llmHashTodos.has(llmHash)) {              llmHashTodos.delete(llmHash);              const hash = llmHashes[llmHash];              dbg(&#x60;translation: %s - %s&#x60;, llmHash, hash);              let chunkTranslated = fence.content.replace(/\r?\n$/, &#x22;&#x22;).trim();              const node = nodes[hash];              dbg(&#x60;original node: %O&#x60;, node);              if (node?.type === &#x22;text&#x22; &#x26;&#x26; /\s$/.test(node.value)) {                dbg(&#x60;patch trailing space for %s&#x60;, hash);                chunkTranslated += &#x22; &#x22;;              }              chunkTranslated = chunkTranslated                .replace(/┌[A-Z]\d{3,5}┐/g, &#x22;&#x22;)                .replace(/└[A-Z]\d{3,5}┘/g, &#x22;&#x22;);              dbg(&#x60;content: %s&#x60;, chunkTranslated);              translationCache[hash] = chunkTranslated;            }          }          lastLLmHashTodos = llmHashTodos.size;        }"><div></div></button></div></figure></div>
<ul>
<li>Met à jour le cache de traduction avec les réponses de l’IA, retire les marqueurs, et continue si des traductions manquent encore.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// apply translations</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">translated </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">structuredClone</span><span style="--0:#D6DEEB;--1:#403F53">(root);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// apply translations</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, nodeTypes, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">yaml</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">data</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">parsers</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">YAML</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (data) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (starlight) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (data</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml hero image: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (Array</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">isArray</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">actions</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">hero</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">actions</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">action</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">link</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                      </span></span><span style="--0:#D6DEEB;--1:#403F53">action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">link</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">link</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                        </span></span><span style="--0:#D6DEEB;--1:#403F53">startlightBaseRx,</span></div></div><div class="ec-line"><div class="code"><span class="indent">                        </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">/</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">starlightBase</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">/</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">toLowerCase</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">/</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                      </span></span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml hero action link: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">link</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml hero.action: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash, tr);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">text</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                    </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (action</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                      </span></span><span style="--0:#D6DEEB;--1:#403F53">action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                      </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml hero action image: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, action</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">image</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">file</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (data</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">?.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml cover image: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">cover</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">image</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml excerpt: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash, tr);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">excerpt</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml title: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash, tr);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">title</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#096E72">typeof</span><span style="--0:#D6DEEB;--1:#403F53"> data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">string</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">nhash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[nhash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">yaml description: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, nhash, tr);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) data</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">description</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">YAML</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(data);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(node);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translation</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[hash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (translation) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">text</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translated text: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, hash, translation);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> translation;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">paragraph</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">||</span><span style="--0:#D6DEEB;--1:#403F53"> node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">heading</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translated %s: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53">, hash, translation);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#C792EA;--1:#8844AE">try</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">newNodes</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#D6DEEB;--1:#403F53">(translation)</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">children</span><span style="--0:#C792EA;--1:#8844AE"> as </span><span style="--0:#FFCB8B;--1:#111111">PhrasingContent</span><span style="--0:#D6DEEB;--1:#403F53">[];</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">children</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">splice</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#D6DEEB;--1:#403F53">, node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">children</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#7FDBCA;--1:#096E72">...</span><span style="--0:#D6DEEB;--1:#403F53">newNodes);</span></div></div><div class="ec-line"><div class="code"><span class="indent">                  </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">catch</span><span style="--0:#D6DEEB;--1:#403F53"> (error) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">error parsing paragraph translation</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, error);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">fence</span><span style="--0:#D6DEEB;--1:#403F53">(node, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">json</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                  </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">fence</span><span style="--0:#D6DEEB;--1:#403F53">(translation);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">untranslated node type: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // apply translations        translated = structuredClone(root);        // apply translations        visit(translated, nodeTypes, (node) => {          if (node.type === &#x22;yaml&#x22;) {            const data = parsers.YAML(node.value);            if (data) {              if (starlight) {                if (data?.hero?.image?.file) {                  data.hero.image.file = patchFn(data.hero.image.file);                  dbg(&#x60;yaml hero image: %s&#x60;, data.hero.image.file);                }                if (Array.isArray(data?.hero?.actions)) {                  data.hero.actions.forEach((action) => {                    if (typeof action.link === &#x22;string&#x22;) {                      action.link = action.link.replace(                        startlightBaseRx,                        &#x60;/${starlightBase}/${to.toLowerCase()}/&#x60;,                      );                      dbg(&#x60;yaml hero action link: %s&#x60;, action.link);                    }                    if (typeof action.text === &#x22;string&#x22;) {                      const nhash = hashNode(action.text);                      const tr = translationCache[nhash];                      dbg(&#x60;yaml hero.action: %s -> %s&#x60;, nhash, tr);                      if (tr) action.text = tr;                    }                    if (action?.image?.file) {                      action.image.file = patchFn(action.image.file);                      dbg(&#x60;yaml hero action image: %s&#x60;, action.image.file);                    }                  });                }                if (data?.cover?.image) {                  data.cover.image = patchFn(data.cover.image);                  dbg(&#x60;yaml cover image: %s&#x60;, data.cover.image);                }              }              if (typeof data.excerpt === &#x22;string&#x22;) {                const nhash = hashNode(data.excerpt);                const tr = translationCache[nhash];                dbg(&#x60;yaml excerpt: %s -> %s&#x60;, nhash, tr);                if (tr) data.excerpt = tr;              }              if (typeof data.title === &#x22;string&#x22;) {                const nhash = hashNode(data.title);                const tr = translationCache[nhash];                dbg(&#x60;yaml title: %s -> %s&#x60;, nhash, tr);                if (tr) data.title = tr;              }              if (typeof data.description === &#x22;string&#x22;) {                const nhash = hashNode(data.description);                const tr = translationCache[nhash];                dbg(&#x60;yaml description: %s -> %s&#x60;, nhash, tr);                if (tr) data.description = tr;              }              node.value = YAML.stringify(data);              return SKIP;            }          } else {            const hash = hashNode(node);            const translation = translationCache[hash];            if (translation) {              if (node.type === &#x22;text&#x22;) {                dbg(&#x60;translated text: %s -> %s&#x60;, hash, translation);                node.value = translation;              } else if (node.type === &#x22;paragraph&#x22; || node.type === &#x22;heading&#x22;) {                dbg(&#x60;translated %s: %s -> %s&#x60;, node.type, hash, translation);                try {                  const newNodes = parse(translation).children as PhrasingContent[];                  node.children.splice(0, node.children.length, ...newNodes);                  return SKIP;                } catch (error) {                  output.error(&#x60;error parsing paragraph translation&#x60;, error);                  output.fence(node, &#x22;json&#x22;);                  output.fence(translation);                }              } else {                dbg(&#x60;untranslated node type: %s&#x60;, node.type);              }            }          }        });"><div></div></button></div></figure></div>
<ul>
<li>Parcourt l’AST et remplace le contenu par la traduction stockée dans le cache.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// patch images and esm imports</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdxjsEsm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">image</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">], </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">image</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">else</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdxjsEsm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#919F9F;--1:#5D6376">// path local imports</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">rx</span><span style="--0:#C792EA;--1:#8844AE"> =</span><span style="--0:#5CA7E4;--1:#3A688F"> </span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#C792EA;--1:#8844AE">^</span><span style="--0:#5CA7E4;--1:#3A688F">(import</span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#F78C6C;--1:#AA0982">\}</span><span style="--0:#5CA7E4;--1:#3A688F">)</span><span style="--0:#82AAFF;--1:#3B61B0">\s</span><span style="--0:#7FDBCA;--1:#096E72">*</span><span style="--0:#5CA7E4;--1:#3A688F">(</span><span style="--0:#82AAFF;--1:#3B61B0">.</span><span style="--0:#7FDBCA;--1:#096E72">*</span><span style="--0:#5CA7E4;--1:#3A688F">)</span><span style="--0:#82AAFF;--1:#3B61B0">\s</span><span style="--0:#7FDBCA;--1:#096E72">+</span><span style="--0:#5CA7E4;--1:#3A688F">from</span><span style="--0:#82AAFF;--1:#3B61B0">\s</span><span style="--0:#7FDBCA;--1:#096E72">+</span><span style="--0:#5CA7E4;--1:#3A688F">(?:</span><span style="--0:#F78C6C;--1:#AA0982">\"</span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#5CA7E4;--1:#3A688F">')(</span><span style="--0:#F78C6C;--1:#AA0982">\.</span><span style="--0:#7FDBCA;--1:#096E72">?</span><span style="--0:#F78C6C;--1:#AA0982">\.\/</span><span style="--0:#82AAFF;--1:#3B61B0">.</span><span style="--0:#7FDBCA;--1:#096E72">*</span><span style="--0:#5CA7E4;--1:#3A688F">)(?:</span><span style="--0:#F78C6C;--1:#AA0982">\"</span><span style="--0:#7FDBCA;--1:#096E72">|</span><span style="--0:#5CA7E4;--1:#3A688F">');</span><span style="--0:#7FDBCA;--1:#096E72">?</span><span style="--0:#C792EA;--1:#8844AE">$</span><span style="--0:#D9F5DD;--1:#111111">/</span><span style="--0:#5CA7E4;--1:#3A688F">gm</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">value</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(rx, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--1:#403F53"><span style="--0:#D7DBE0">m</span><span style="--0:#D6DEEB">, </span><span style="--0:#D7DBE0">k</span><span style="--0:#D6DEEB">, </span><span style="--0:#D7DBE0">i</span><span style="--0:#D6DEEB">, </span><span style="--0:#D7DBE0">p</span></span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">pp</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(p);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">r</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">k</span><span style="--0:#C792EA;--1:#8844AE"> === </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">}</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE"> ? </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">} from "</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">pp</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">";</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE"> : </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">import </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">i</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> from "</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">pp</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">";</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">mdxjsEsm import: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, m, r);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> r;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">return</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">SKIP</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // patch images and esm imports        visit(translated, [&#x22;mdxjsEsm&#x22;, &#x22;image&#x22;], (node) => {          if (node.type === &#x22;image&#x22;) {            node.url = patchFn(node.url);            return SKIP;          } else if (node.type === &#x22;mdxjsEsm&#x22;) {            // path local imports            const rx = /^(import|\})\s*(.*)\s+from\s+(?:\&#x22;|&#x27;)(\.?\.\/.*)(?:\&#x22;|&#x27;);?$/gm;            node.value = node.value.replace(rx, (m, k, i, p) => {              const pp = patchFn(p);              const r = k === &#x22;}&#x22; ? &#x60;} from &#x22;${pp}&#x22;;&#x60; : &#x60;import ${i} from &#x22;${pp}&#x22;;&#x60;;              dbg(&#x60;mdxjsEsm import: %s -> %s&#x60;, m, r);              return r;            });            return SKIP;          }        });"><div></div></button></div></figure></div>
<ul>
<li>Corrige les chemins d’images et les imports pour les fichiers traduits.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdxJsxFlowElement</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">], </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">flow</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE"> as </span><span style="--0:#FFCB8B;--1:#111111">MdxJsxFlowElement</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">for</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">attribute</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#7FDBCA;--1:#096E72">of</span><span style="--0:#D6DEEB;--1:#403F53"> flow</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">attributes</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">||</span><span style="--0:#D6DEEB;--1:#403F53"> []) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">type</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">mdxJsxAttribute</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">&#x26;&#x26;</span><span style="--0:#D6DEEB;--1:#403F53"> attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">name</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">title</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">hash</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">hashNode</span><span style="--0:#D6DEEB;--1:#403F53">(attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">tr</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#D6DEEB;--1:#403F53">translationCache[hash];</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (tr) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translate title: %s -> %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, hash, tr);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">attribute</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">value</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> tr;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        visit(translated, [&#x22;mdxJsxFlowElement&#x22;], (node) => {          const flow = node as MdxJsxFlowElement;          for (const attribute of flow.attributes || []) {            if (attribute.type === &#x22;mdxJsxAttribute&#x22; &#x26;&#x26; attribute.name === &#x22;title&#x22;) {              const hash = hashNode(attribute.value);              const tr = translationCache[hash];              if (tr) {                dbg(&#x60;translate title: %s -> %s&#x60;, hash, tr);                attribute.value = tr;              }            }          }        });"><div></div></button></div></figure></div>
<ul>
<li>Traduit l’attribut title des composants MDX JSX.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// patch links</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">link</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (startlightBaseRx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">test</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">patchFn</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#FAF39F;--1:#111111">url</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">replace</span><span style="--0:#D6DEEB;--1:#403F53">(startlightBaseRx, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">../</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">), </span><span style="--0:#FF6A83;--1:#A24848">true</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // patch links        visit(translated, &#x22;link&#x22;, (node) => {          if (startlightBaseRx.test(node.url)) {            node.url = patchFn(node.url.replace(startlightBaseRx, &#x22;../&#x22;), true);          }        });"><div></div></button></div></figure></div>
<ul>
<li>Met à jour les liens de documentation internes selon le dossier de traduction.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgt</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">stringifying %O</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, translated</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">children</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">let </span><span style="--0:#D6DEEB;--1:#403F53">contentTranslated</span><span style="--0:#C792EA;--1:#8844AE"> = await </span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(translated);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (content </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> contentTranslated) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">warn</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Unable to translate anything, skipping file.</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">continue</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        dbgt(&#x60;stringifying %O&#x60;, translated.children);        let contentTranslated = await stringify(translated);        if (content === contentTranslated) {          output.warn(&#x60;Unable to translate anything, skipping file.&#x60;);          continue;        }"><div></div></button></div></figure></div>
<ul>
<li>Reconvertit l’AST en Markdown, et saute les fichiers inchangés.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// validate it stills parses as Markdown</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">try</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">parse</span><span style="--0:#D6DEEB;--1:#403F53">(contentTranslated);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">catch</span><span style="--0:#D6DEEB;--1:#403F53"> (error) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">error</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Translated content is not valid Markdown</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, error);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">diff</span><span style="--0:#D6DEEB;--1:#403F53">(content, contentTranslated);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">continue</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // validate it stills parses as Markdown        try {          parse(contentTranslated);        } catch (error) {          output.error(&#x60;Translated content is not valid Markdown&#x60;, error);          output.diff(content, contentTranslated);          continue;        }"><div></div></button></div></figure></div>
<ul>
<li>Valide que la sortie est toujours un Markdown valide.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// validate all external links</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// have same domain</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">originalLinks</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#7FDBCA;--1:#096E72">new</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#82AAFF;--1:#3B61B0">Set</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">></span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(root, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">link</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#82AAFF;--1:#3B61B0">isUri</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">originalLinks</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">translatedLinks</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#7FDBCA;--1:#096E72">new</span><span style="--0:#C792EA;--1:#8844AE"> </span><span style="--0:#82AAFF;--1:#3B61B0">Set</span><span style="--0:#C792EA;--1:#8844AE">&#x3C;</span><span style="--0:#C5E478;--1:#3B61B0">string</span><span style="--0:#C792EA;--1:#8844AE">></span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">visit</span><span style="--0:#D6DEEB;--1:#403F53">(translated, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">link</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">node</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">=></span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#82AAFF;--1:#3B61B0">isUri</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">              </span></span><span style="--0:#D6DEEB;--1:#403F53">translatedLinks</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">add</span><span style="--0:#D6DEEB;--1:#403F53">(node</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">url</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">});</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">diffLinks</span><span style="--0:#C792EA;--1:#8844AE"> = </span><span style="--0:#82AAFF;--1:#3B61B0">xor</span><span style="--0:#D6DEEB;--1:#403F53">(Array</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">from</span><span style="--0:#D6DEEB;--1:#403F53">(originalLinks)</span><span style="--0:#C792EA;--1:#8844AE">, </span><span style="--0:#D6DEEB;--1:#403F53">Array</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">from</span><span style="--0:#D6DEEB;--1:#403F53">(translatedLinks));</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (diffLinks</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">length</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">warn</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">some links have changed</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">fence</span><span style="--0:#D6DEEB;--1:#403F53">(diffLinks, </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">yaml</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // validate all external links        // have same domain        {          const originalLinks = new Set<string>();          visit(root, &#x22;link&#x22;, (node) => {            if (isUri(node.url)) {              originalLinks.add(node.url);            }          });          const translatedLinks = new Set<string>();          visit(translated, &#x22;link&#x22;, (node) => {            if (isUri(node.url)) {              translatedLinks.add(node.url);            }          });          const diffLinks = xor(Array.from(originalLinks), Array.from(translatedLinks));          if (diffLinks.length) {            output.warn(&#x60;some links have changed&#x60;);            output.fence(diffLinks, &#x22;yaml&#x22;);          }        }"><div></div></button></div></figure></div>
<ul>
<li>Vérifie que les liens externes n’ont pas été modifiés par la traduction.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (attempts) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#919F9F;--1:#5D6376">// judge quality is good enough</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">const </span><span style="--0:#82AAFF;--1:#3B61B0">res</span><span style="--0:#C792EA;--1:#8844AE"> = await </span><span style="--0:#82AAFF;--1:#3B61B0">classify</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">ctx</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8844AE"> => {</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#D6DEEB;--1:#403F53">ctx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">$</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">You are an expert at judging the quality of translations.</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">          </span></span><span style="--0:#ECC48D;--1:#3B61B0">Your task is to determine the quality of the translation of a Markdown document from English to </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">lang</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> (</span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">).</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#ECC48D;--1:#3B61B0">          </span></span><span style="--0:#ECC48D;--1:#3B61B0">The original document is in </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">ctx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">def</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">ORIGINAL</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">content)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0">, and the translated document is provided in </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">ctx</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">def</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#ECC48D;--1:#984E4D">TRANSLATED</span><span style="--0:#D6DEEB;--1:#403F53">"</span><span style="--0:#E2817F;--1:#B23834">, </span><span style="--0:#D6DEEB;--1:#403F53">contentTranslated</span><span style="--0:#E2817F;--1:#B23834">, { lineNumbers: </span><span style="--0:#FF6A83;--1:#A24848">true</span><span style="--0:#E2817F;--1:#B23834"> }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> (line numbers were added).</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">role</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">system</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8844AE">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">ok: </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Translation is faithful to the original document and conveys the same meaning.</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">bad: </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Translation is of low quality or has a different meaning from the original.</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">label: </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">judge translation </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">to</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#ECC48D;--1:#3B61B0"> </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#82AAFF;--1:#3B61B0">basename</span><span style="--0:#D6DEEB;--1:#403F53">(filename)</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">explanations: </span><span style="--0:#FF6A83;--1:#A24848">true</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">system:</span><span style="--0:#D6DEEB;--1:#403F53"> [</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">system.annotations</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">              </span></span><span style="--0:#C792EA;--1:#8844AE">systemSafety: </span><span style="--0:#FF6A83;--1:#A24848">false</span><span style="--0:#C792EA;--1:#8844AE">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C792EA;--1:#8844AE">            </span></span><span style="--0:#C792EA;--1:#8844AE">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">resultItem</span><span style="--0:#D6DEEB;--1:#403F53">(res</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">label</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">ok</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">Translation quality: </span><span style="--0:#E2817F;--1:#B23834">${</span><span style="--0:#D6DEEB;--1:#403F53">res</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">label</span><span style="--0:#E2817F;--1:#B23834">}</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">if</span><span style="--0:#D6DEEB;--1:#403F53"> (res</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">label</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">!==</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">ok</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">fence</span><span style="--0:#D6DEEB;--1:#403F53">(res</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#7FDBCA;--1:#096E72">answer</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">diff</span><span style="--0:#D6DEEB;--1:#403F53">(content, contentTranslated);</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C792EA;--1:#8844AE">continue</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        if (attempts) {          // judge quality is good enough          const res = await classify(            (ctx) => {              ctx.$&#x60;You are an expert at judging the quality of translations.          Your task is to determine the quality of the translation of a Markdown document from English to ${lang} (${to}).          The original document is in ${ctx.def(&#x22;ORIGINAL&#x22;, content)}, and the translated document is provided in ${ctx.def(&#x22;TRANSLATED&#x22;, contentTranslated, { lineNumbers: true })} (line numbers were added).&#x60;.role(                &#x22;system&#x22;,              );            },            {              ok: &#x60;Translation is faithful to the original document and conveys the same meaning.&#x60;,              bad: &#x60;Translation is of low quality or has a different meaning from the original.&#x60;,            },            {              label: &#x60;judge translation ${to} ${basename(filename)}&#x60;,              explanations: true,              system: [&#x22;system.annotations&#x22;],              systemSafety: false,            },          );          output.resultItem(res.label === &#x22;ok&#x22;, &#x60;Translation quality: ${res.label}&#x60;);          if (res.label !== &#x22;ok&#x22;) {            output.fence(res.answer);            output.diff(content, contentTranslated);            continue;          }        }"><div></div></button></div></figure></div>
<ul>
<li>Utilise <code dir="auto">classify</code> de GenAIScript Runtime pour demander à l’IA si la traduction est suffisamment fidèle.</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#919F9F;--1:#5D6376">// apply translations and save</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbgc</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">translated: %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, contentTranslated);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#82AAFF;--1:#3B61B0">dbg</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#ECC48D;--1:#3B61B0">writing translation to %s</span><span style="--0:#D6DEEB;--1:#403F53">`</span><span style="--0:#D6DEEB;--1:#403F53">, translationFn);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">await</span><span style="--0:#D6DEEB;--1:#403F53"> workspace</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">writeText</span><span style="--0:#D6DEEB;--1:#403F53">(translationFn, contentTranslated);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">await</span><span style="--0:#D6DEEB;--1:#403F53"> workspace</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">writeText</span><span style="--0:#D6DEEB;--1:#403F53">(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">translationCacheFilename,</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#82AAFF;--1:#3B61B0">JSON</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">stringify</span><span style="--0:#D6DEEB;--1:#403F53">(translationCache, </span><span style="--0:#FF6A83;--1:#A24848">null</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">),</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">} </span><span style="--0:#C792EA;--1:#8844AE">catch</span><span style="--0:#D6DEEB;--1:#403F53"> (error) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">output</span><span style="--0:#C792EA;--1:#8844AE">.</span><span style="--0:#82AAFF;--1:#3B61B0">error</span><span style="--0:#D6DEEB;--1:#403F53">(error);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C792EA;--1:#8844AE">break</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copier dans le presse-papiers" data-copied="Copié !" data-code="        // apply translations and save        dbgc(&#x60;translated: %s&#x60;, contentTranslated);        dbg(&#x60;writing translation to %s&#x60;, translationFn);        await workspace.writeText(translationFn, contentTranslated);        await workspace.writeText(          translationCacheFilename,          JSON.stringify(translationCache, null, 2),        );      } catch (error) {        output.error(error);        break;      }    }  }}"><div></div></button></div></figure></div>
<ul>
<li>Écrit le Markdown traduit et met à jour le cache pour les prochaines exécutions.</li>
</ul>  <div class="post-footer astro-5xgx7x34"> <div class="astro-vizeafcz"><b class="astro-vizeafcz">Étiquettes :</b><ul class="astro-vizeafcz"><li class="astro-vizeafcz"><a href="/genaiscript/fr/blog/tags/continuous-ai/" class="astro-vizeafcz">Continuous AI</a></li><li class="astro-vizeafcz"><a href="/genaiscript/fr/blog/tags/cicd/" class="astro-vizeafcz">CI/CD</a></li><li class="astro-vizeafcz"><a href="/genaiscript/fr/blog/tags/translations/" class="astro-vizeafcz">Translations</a></li></ul></div> <div class="pagination astro-eovlio7b" data-pagefind-ignore><div class="card-grid astro-ymfibcsc"><div class="sl-link-card astro-7m3pweiq"> <span class="sl-flex stack astro-7m3pweiq"> <a href="/genaiscript/fr/blog/v2/" rel="next" class="astro-eovlio7b astro-7m3pweiq"> <span class="title astro-7m3pweiq">2.0 - Une bibliothèque Node.JS</span> </a>  </span> <svg aria-hidden="true" class="icon rtl:flip astro-7m3pweiq astro-bq6csbgl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.333em;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg> </div> </div> </div> </div> </div>  <footer>
Built with 💗 by Microsoft |
<a href="https://microsoft.github.io/genaiscript/llms-full.txt" target="_blank" rel="noopener noreferrer">Docs for LLMS</a>
| <a href="https://go.microsoft.com/fwlink/?LinkId=521839" target="_blank" rel="noopener noreferrer">Privacy &amp; Cookies</a>
| <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/copyright" target="_blank" rel="noopener noreferrer">Terms of Use</a>
| <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks/usage/general" target="_blank" rel="noopener noreferrer">Trademarks</a>
| <a href="https://go.microsoft.com/fwlink/?linkid=2259814" target="_blank" rel="noopener noreferrer">Consumer Health Privacy</a> </footer> </div> </div>   </main> </div> </div>  </div> </div>  </body></html>