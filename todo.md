# TODO

## Demo example

User wants to create a image resize app

User opens a markdown file and enters text

```md
# Image resize

A command line that takes a file name, a size and resize the picture.
```

A node appears in the coarch treeview. The user clicks on 
`generate tasks` in the context menu.

CoArch generates new tasks, and displays a preview of the changes to the user (using Refactoring UI).

User rejects the change, add node.js requirements.

```md
# Image resize

A command line that takes a file name, a size and resize the picture. Use node.js.
```


User clicks again on `generate tasks` and commits the changes.
CoArch also add ids to all markdown titles

```md
# Image resize {#1}

A command line that takes a file name, a size and resize the picture. Use node.js.

## Parse arguments {#2}

Read the file name, size and output file name
from the command line arguments.

## Read file {#3}

Read file binary into an image representation.

## Resize image {#4}

Using image library to resize image using the best algorithm.

## Save image {#5}

Use file APIs to save image to output file.
```

The developer click on the `parse args` node
and selects `generate code`. Developer saves the code.

He realizes he want to use commander, so updates the 
markdown for task 2.

```md
## Parse arguments {#2}

Read the file name, size and output file name
from the command line arguments.

Use npm package commander.
```

The code node becomes "unsync" and the parent node also unsync.

On the parent node, the dev can `validate node` or `update node`.
Developer clicks `update node` and accepts the update generated
by the LLM.

For the code node, developer can `regenerate code` or `update code`.
Developer click `update code` again and looks at the diff,
accepts diff and patches the broken pieces of the edit.

```ts
/**
 * Parses arguments.... (this is a summary of the task generated by LLM)
 * { @link spec.md#2 | Parse arguments }
 */
function parseArgument() {
    ...
}
```

The treeview reflects that there is a code node now available.

## Todos

- [ ] document tree structure M
- [ ] markdown/typescript parser M
- [ ] tree view representation of the tree P
- [ ] refactoring provider implementation for updates P
- [ ] detection and quickfix of duplicate ids P
- [ ] calling open ai M
- [ ] cache of LLM query M 
- [ ] detect sync/out of sync nodes M
- [ ] project wide code generation preferences (`prompts/code.md`, `prompts/task.md`, `prompts/general.md`) M

## TBD

- [ ] extensible prompts?
